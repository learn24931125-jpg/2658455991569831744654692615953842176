<H1>æ™ºæ…§æ—…éŠå°è¦½</H1>
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ™ºæ…§æ—…éŠå°è¦½ç³»çµ± - å°ç£ (Gemini æ•´åˆç‰ˆ)</title>
    <style>
        /* Neumorphism æŸ”å’Œäºå…‹åŠ›é¢¨æ ¼ åŸºç¤è¨­å®š */
        :root {
            --bg-color: #e0e5ec; /* æŸ”å’ŒèƒŒæ™¯è‰² */
            --light-shadow: #ffffff; /* äº®é¢é™°å½± */
            --dark-shadow: #a3b1c6; /* æš—é¢é™°å½± */
            --primary-color: #4a86e8; /* ä¸»é¡Œè‰² (è—è‰²) */
            --text-color: #333;
            --container-padding: 20px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        /* Neumorphism åŸºç¤å…ƒä»¶æ¨£å¼ */
        .neumo-card {
            background: var(--bg-color);
            border-radius: 25px;
            padding: var(--container-padding);
            box-shadow: 8px 8px 16px var(--dark-shadow), 
                        -8px -8px 16px var(--light-shadow);
            margin-bottom: 20px;
            width: 100%;
            transition: all 0.3s ease;
        }

        .neumo-inset {
            background: var(--bg-color);
            border-radius: 15px;
            box-shadow: inset 5px 5px 10px var(--dark-shadow), 
                        inset -5px -5px 10px var(--light-shadow);
            padding: 10px 15px;
            margin-bottom: 15px;
        }

        .neumo-button {
            background: var(--bg-color);
            border: none;
            border-radius: 15px;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            color: var(--text-color);
            box-shadow: 4px 4px 8px var(--dark-shadow), 
                        -4px -4px 8px var(--light-shadow);
            transition: all 0.2s ease;
        }

        .neumo-button:hover {
            box-shadow: 6px 6px 12px var(--dark-shadow), 
                        -6px -6px 12px var(--light-shadow);
        }

        .neumo-button:active {
            box-shadow: inset 4px 4px 8px var(--dark-shadow), 
                        inset -4px -4px 8px var(--light-shadow);
        }

        .neumo-input {
            width: 100%;
            padding: 10px 15px;
            border: none;
            background: var(--bg-color);
            border-radius: 10px;
            color: var(--text-color);
            box-shadow: inset 2px 2px 5px var(--dark-shadow), 
                        inset -2px -2px 5px var(--light-shadow);
        }

        /* ä½ˆå±€å’Œä¸»è¦å€å¡Šæ¨£å¼ */
        #header-area {
            text-align: center;
        }

        #main-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            width: 90%;
            max-width: 1400px;
            margin-top: 20px;
        }

        #sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* æ™¯é»é¸å–® (Scrollable List) */
        #menu-list {
            list-style: none;
            padding: 0;
            max-height: 400px;
            overflow-y: auto;
            border-radius: 15px;
        }

        .tour-item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 15px;
            background: var(--bg-color);
            cursor: pointer;
            box-shadow: 4px 4px 8px var(--dark-shadow), -4px -4px 8px var(--light-shadow);
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .tour-item:hover {
            box-shadow: 6px 6px 12px var(--dark-shadow), -6px -6px 12px var(--light-shadow);
            transform: translateY(-2px);
        }

        .tour-item.active {
            /* é»æ“Šå¾Œçš„å‡¹é™·æ•ˆæœ */
            box-shadow: inset 4px 4px 8px var(--dark-shadow), inset -4px -4px 8px var(--light-shadow);
            color: var(--primary-color);
            font-weight: bold;
        }

        /* æ™¯é»å¡ç‰‡å€ */
        #spot-card-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        #spot-card h3 {
            border-bottom: 2px solid var(--dark-shadow);
            padding-bottom: 10px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        #spot-image-container {
            min-height: 300px;
            background: var(--bg-color);
            border-radius: 15px;
            /* å…§å‡¹ä»¥é¡¯ç¤ºåœ–ç‰‡æˆ–è¼‰å…¥ç‹€æ…‹ */
            box-shadow: inset 5px 5px 10px var(--dark-shadow), inset -5px -5px 10px var(--light-shadow);
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
            overflow: hidden;
            position: relative;
        }

        #spot-image-container img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 15px;
            display: none; 
            transition: opacity 0.5s ease;
        }

        .loading-text {
            color: var(--dark-shadow);
            font-style: italic;
            padding: 15px;
            text-align: center;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }

        /* åœ°åœ–å±•ç¤ºå€ (æ¨¡æ“¬) */
        #map-area {
            min-height: 300px;
            width: 100%;
            background-color: #cad1db; 
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #4a4a4a;
            font-size: 1.2em;
        }

        #map-area p {
            padding: 10px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 900px) {
            #main-container {
                grid-template-columns: 1fr;
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <header id="header-area" class="neumo-card" style="width: 90%; max-width: 1400px;">
        <h1>ğŸŒŸ AIæ™ºæ…§æ—…éŠå°è¦½ç³»çµ± (å°ç£)</h1>
        <p>è¦åŠƒæ‚¨çš„å°ç£æ™ºæ…§ä¹‹æ—…ï¼Œé€é Gemini AI æ¢ç´¢æ™¯é»ï¼</p>
    </header>

    <div id="main-container">
        <aside id="sidebar">
            
            <div id="api-setting-area" class="neumo-card">
                <h3>ğŸ”‘ AI æœå‹™è¨­å®š</h3>
                <div class="neumo-inset">
                    <label for="apiKey">è¼¸å…¥æ‚¨çš„ API Key:</label>
                    <input type="text" id="apiKey" class="neumo-input" placeholder="ç”¨æ–¼æ‚¨çš„å¾Œç«¯/ä»£ç†æœå‹™">
                    <small id="api-status" style="display: block; margin-top: 5px; color: orange;">(æœªé©—è­‰ã€‚å»ºè­°åœ¨å¾Œç«¯ä½¿ç”¨)</small>
                </div>
                <button id="validate-btn" class="neumo-button" style="width: 100%;">é©—è­‰/æ¨¡æ“¬é€£ç·š</button>
            </div>

            <div id="attraction-menu-area" class="neumo-card">
                <h3>ğŸ“ å°ç£ç²¾é¸æ™¯é»</h3>
                <ul id="menu-list">
                    </ul>
            </div>
        </aside>

        <section id="content-area">

            <div id="spot-card-area" class="neumo-card">
                <h3>ğŸï¸ æ™¯é»ä»‹ç´¹ (ç”± AI ç”Ÿæˆ)</h3>
                <div id="spot-card">
                    <h3 id="spot-name">è«‹é»é¸å·¦å´æ™¯é»ä»¥é–‹å§‹å°è¦½</h3>
                    <p id="spot-description">é€™è£¡å°‡é¡¯ç¤ºç”± Gemini AI ç”Ÿæˆçš„æ™¯é»è©³ç´°ä»‹ç´¹ã€‚</p>
                    <p id="spot-coords" style="font-size: 0.9em; margin-top: 10px;">åº§æ¨™: N/A</p>
                    <button id="generate-image-btn" class="neumo-button" style="margin-top: 15px;" disabled>
                        âœ¨ æ¨¡æ“¬ AI (Imagen) ç”Ÿæˆæ™¯é»åœ–ç‰‡
                    </button>

                    <div id="spot-image-container">
                        <p class="loading-text">æ™¯é»åœ–ç‰‡å°‡åœ¨æ­¤è™•é¡¯ç¤º...</p>
                        <img id="spot-image" src="" alt="æ™¯é»åœ–ç‰‡" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                </div>
            </div>

            <div id="map-area" class="neumo-card">
                <h3>ğŸ—ºï¸ è·¯ç·šèˆ‡åœ°åœ–å±•ç¤º</h3>
                <p id="map-status">åœ°åœ–å°‡é¡¯ç¤ºæ™¯é»åº§æ¨™è³‡è¨Š</p>
            </div>

        </section>
    </div>

    <script>
        // å°ç£æ—…éŠæ™¯é»è³‡æ–™ (åƒ…åŒ…å«åŸºæœ¬è³‡è¨Šå’Œ AI æç¤ºè©)
        const attractions = [
            { id: 1, name: "å°åŒ— 101", query: "ç”¨æŸ”å’Œã€ç°¡æ½”çš„é¢¨æ ¼ï¼Œä»‹ç´¹å°åŒ— 101 çš„ç‰¹è‰²ã€æ­·å²æ„ç¾©èˆ‡æœ€ä½³åƒè§€æ™‚æ©Ÿã€‚ç”¨ç¹é«”ä¸­æ–‡ï¼Œå…§å®¹ç´„ 150 å­—ã€‚", lat: 25.0330, lon: 121.5654, description: 'é»æ“Šæ™¯é»å¾Œï¼ŒAI å°‡ç”Ÿæˆæ›´è±å¯Œçš„ä»‹ç´¹...' },
            { id: 2, name: "å¤ªé­¯é–£åœ‹å®¶å…¬åœ’", query: "ç”¨å¯Œæœ‰è©©æ„ã€å£¯éº—çš„é¢¨æ ¼ï¼Œä»‹ç´¹èŠ±è“®å¤ªé­¯é–£åœ‹å®¶å…¬åœ’çš„å³½è°·æ™¯è§€ã€ç‡•å­å£èˆ‡éŒéº“å¤é“ã€‚ç”¨ç¹é«”ä¸­æ–‡ï¼Œå…§å®¹ç´„ 150 å­—ã€‚", lat: 24.1700, lon: 121.6100, description: 'é»æ“Šæ™¯é»å¾Œï¼ŒAI å°‡ç”Ÿæˆæ›´è±å¯Œçš„ä»‹ç´¹...' },
            { id: 3, name: "æ—¥æœˆæ½­", query: "ç”¨å¯§éœã€å„ªç¾çš„é¢¨æ ¼ï¼Œä»‹ç´¹å—æŠ•æ—¥æœˆæ½­çš„æ¹–å…‰å±±è‰²ã€é‚µæ—æ–‡åŒ–èˆ‡éŠæ¹–æ–¹å¼ã€‚ç”¨ç¹é«”ä¸­æ–‡ï¼Œå…§å®¹ç´„ 150 å­—ã€‚", lat: 23.8333, lon: 120.9000, description: 'é»æ“Šæ™¯é»å¾Œï¼ŒAI å°‡ç”Ÿæˆæ›´è±å¯Œçš„ä»‹ç´¹...' },
            { id: 4, name: "é˜¿é‡Œå±±", query: "ç”¨æ¸…æ–°ã€å¤¢å¹»çš„é¢¨æ ¼ï¼Œä»‹ç´¹é˜¿é‡Œå±±çš„æ—¥å‡ºã€é›²æµ·ã€ç¥æœ¨èˆ‡æ£®æ—éµè·¯ã€‚ç”¨ç¹é«”ä¸­æ–‡ï¼Œå…§å®¹ç´„ 150 å­—ã€‚", lat: 23.5100, lon: 120.8000, description: 'é»æ“Šæ™¯é»å¾Œï¼ŒAI å°‡ç”Ÿæˆæ›´è±å¯Œçš„ä»‹ç´¹...' },
        ];

        let currentAPIKey = '';
        let currentSpot = null;

        // *** ã€é‡è¦ã€‘è«‹æ›¿æ›ç‚ºæ‚¨çš„å¾Œç«¯ä»£ç†ç¶²å€æˆ– SDK åˆå§‹åŒ–é‚è¼¯ ***
        const GEMINI_TEXT_API_ENDPOINT = 'YOUR_TEXT_GENERATION_PROXY_ENDPOINT'; 
        const GEMINI_IMAGE_API_ENDPOINT = 'YOUR_IMAGE_GENERATION_PROXY_ENDPOINT';
        // ***************************************************************

        // --- å•Ÿå‹•å‡½å¼ ---
        document.addEventListener('DOMContentLoaded', () => {
            loadAttractionMenu();
            document.getElementById('validate-btn').addEventListener('click', validateConnection);
            document.getElementById('generate-image-btn').addEventListener('click', generateImage);
        });

        // --- æ™¯é»é¸å–®è¼‰å…¥ ---
        function loadAttractionMenu() {
            const menuList = document.getElementById('menu-list');
            menuList.innerHTML = '';
            attractions.forEach(spot => {
                const li = document.createElement('li');
                li.className = 'tour-item';
                li.textContent = spot.name;
                li.dataset.id = spot.id;
                li.addEventListener('click', () => selectSpot(spot.id));
                menuList.appendChild(li);
            });
        }

        // --- æ¨¡æ“¬ API é€£ç·šé©—è­‰ ---
        function validateConnection() {
            const apiKeyInput = document.getElementById('apiKey');
            const apiStatus = document.getElementById('api-status');
            const key = apiKeyInput.value.trim();

            if (key.length > 10) {
                currentAPIKey = key;
                apiStatus.textContent = 'âœ… API é€£ç·šæ¨¡æ“¬æˆåŠŸã€‚è«‹é¸æ“‡æ™¯é»ï¼';
                apiStatus.style.color = 'green';
                document.getElementById('generate-image-btn').disabled = false;
            } else {
                currentAPIKey = '';
                apiStatus.textContent = 'âŒ è«‹è¼¸å…¥ Key (åƒ…ç‚ºæ¨¡æ“¬é©—è­‰ï¼Œè«‹å‹¿åœ¨æ­¤è™•æš´éœ²çœŸå¯¦ API Key)';
                apiStatus.style.color = 'red';
                document.getElementById('generate-image-btn').disabled = true;
            }
        }

        // --- é»é¸æ™¯é» ---
        function selectSpot(id) {
            const spot = attractions.find(s => s.id === id);
            if (!spot) return;

            currentSpot = spot;

            // æ›´æ–°é¸å–®æ¨£å¼
            document.querySelectorAll('.tour-item').forEach(item => item.classList.remove('active'));
            document.querySelector(`.tour-item[data-id="${id}"]`).classList.add('active');

            // æ›´æ–°æ™¯é»å¡ç‰‡åŸºæœ¬è³‡è¨Š
            document.getElementById('spot-name').textContent = `ğŸ“ ${spot.name}`;
            document.getElementById('spot-coords').textContent = `åº§æ¨™: ${spot.lat}Â° N, ${spot.lon}Â° E`;

            // æ›´æ–°åœ°åœ–å±•ç¤ºå€ (æ¨¡æ“¬)
            document.getElementById('map-status').innerHTML = 
                `<strong>ğŸ—ºï¸ æ¨¡æ“¬åœ°åœ–ï¼š</strong><br>
                æ™¯é»ï¼š${spot.name}<br>
                åº§æ¨™ï¼š(${spot.lat}, ${spot.lon})<br>
                <small>ï¼ˆæ­¤è™•å¯åµŒå…¥å¯¦éš› Google Maps æˆ– Leaflet åœ°åœ–ï¼‰</small>`;
            
            // é‡ç½®åœ–ç‰‡å€
            const imageContainer = document.getElementById('spot-image-container');
            const spotImage = document.getElementById('spot-image');
            imageContainer.querySelector('.loading-text').textContent = 'é»æ“ŠæŒ‰éˆ•æ¨¡æ“¬ AI ç”Ÿæˆåœ–ç‰‡...';
            imageContainer.querySelector('.loading-text').style.display = 'block';
            spotImage.style.display = 'none';
            spotImage.src = '';

            // å‘¼å« Gemini å‡½å¼ç”Ÿæˆæ™¯é»ä»‹ç´¹
            fetchGeminiDescription(spot.query);
        }
        
        // --- 1. é€é Gemini API ç”Ÿæˆæ™¯é»ä»‹ç´¹ ---
        async function fetchGeminiDescription(prompt) {
            const descElement = document.getElementById('spot-description');
            
            descElement.innerHTML = 'AI æœå‹™é€£ç·šä¸­... æ­£åœ¨ç”Ÿæˆæ™¯é»ä»‹ç´¹... <span class="loading-text" style="display:inline;"></span>';
            descElement.style.fontStyle = 'italic';

            try {
                // å¯¦éš›çš„ API å‘¼å« (è«‹å°‡ GEMINI_TEXT_API_ENDPOINT æ›¿æ›ç‚ºæ‚¨çš„å¾Œç«¯ä»£ç†ç¶²å€)
                const response = await fetch(GEMINI_TEXT_API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        prompt: prompt,
                        apiKey: currentAPIKey // å¯¦éš›ä½¿ç”¨æ™‚ï¼Œæ‡‰ç”±å¾Œç«¯è™•ç†æ­¤ Key
                    })
                });

                if (!response.ok) {
                    throw new Error(`API è«‹æ±‚å¤±æ•—: ${response.status}`);
                }
                
                // å‡è¨­ API å›å‚³ JSON æ ¼å¼ç‚º { "text": "æ™¯é»ä»‹ç´¹å…§å®¹" }
                const data = await response.json();
                
                // æ¨¡æ“¬/æ›¿æ›ç‚º AI ç”Ÿæˆçš„å…§å®¹
                const generatedText = data.text || `[æ¨¡æ“¬] AI æœå‹™å·²é€£ç·šï¼Œé€™æ˜¯é—œæ–¼ ${currentSpot.name} çš„ç°¡çŸ­æè¿°ã€‚${prompt}`;

                descElement.textContent = generatedText;
                descElement.style.fontStyle = 'normal';

            } catch (error) {
                console.error("ç”Ÿæˆä»‹ç´¹å¤±æ•—:", error);
                descElement.textContent = `âŒ ä»‹ç´¹ç”Ÿæˆå¤±æ•—ã€‚è«‹æª¢æŸ¥ API ä»£ç†æœå‹™æ˜¯å¦æ­£å¸¸é€£ç·šã€‚éŒ¯èª¤: ${error.message}`;
                descElement.style.color = 'red';
            }
        }
        
        // --- 2. é€é Imagen/å…¶ä»– AI æ¨¡å‹ç”Ÿæˆæ™¯é»åœ–ç‰‡ ---
        async function generateImage() {
            if (!currentAPIKey || !currentSpot) {
                alert('è«‹å…ˆé©—è­‰é€£ç·šä¸¦é¸æ“‡ä¸€å€‹æ™¯é»ï¼');
                return;
            }

            const imageContainer = document.getElementById('spot-image-container');
            const spotImage = document.getElementById('spot-image');
            const loadingText = imageContainer.querySelector('.loading-text');
            const generateBtn = document.getElementById('generate-image-btn');
            
            const imagePrompt = `å°ç£æ™¯é»ï¼Œ${currentSpot.name}ï¼Œæ–°æ“¬ç‰©åŒ– (Neumorphism) é¢¨æ ¼çš„æ’ç•«ï¼ŒæŸ”å’Œå…‰ç·šï¼Œé«˜è³ªæ„Ÿã€‚`;

            // 1. è¼‰å…¥ç‹€æ…‹
            generateBtn.disabled = true;
            generateBtn.textContent = `âœ¨ æ­£åœ¨ç”Ÿæˆåœ–ç‰‡ï¼šã€Œ${currentSpot.name}ã€...`;
            loadingText.textContent = `AI æ­£åœ¨ç‚ºã€Œ${currentSpot.name}ã€ç¹ªè£½åœ–ç‰‡ï¼Œæç¤ºè©ï¼š${imagePrompt}`;
            loadingText.style.display = 'block';
            spotImage.style.display = 'none';

            try {
                // å¯¦éš›çš„åœ–ç‰‡ç”Ÿæˆ API å‘¼å« (è«‹å°‡ GEMINI_IMAGE_API_ENDPOINT æ›¿æ›ç‚ºæ‚¨çš„å¾Œç«¯ä»£ç†ç¶²å€)
                const response = await fetch(GEMINI_IMAGE_API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        prompt: imagePrompt,
                        apiKey: currentAPIKey // å¯¦éš›ä½¿ç”¨æ™‚ï¼Œæ‡‰ç”±å¾Œç«¯è™•ç†æ­¤ Key
                    })
                });

                if (!response.ok) {
                    throw new Error(`åœ–ç‰‡ API è«‹æ±‚å¤±æ•—: ${response.status}`);
                }
                
                // å‡è¨­ API å›å‚³ JSON æ ¼å¼ç‚º { "imageUrl": "base64 æˆ–å…¬é–‹ URL" }
                const data = await response.json();

                // æ¨¡æ“¬åœ–ç‰‡ URL (å¯¦éš›æ‡‰ç‚º data.imageUrl)
                const mockImageUrl = `https://picsum.photos/seed/${currentSpot.id + 100}/800/600`;

                spotImage.src = data.imageUrl || mockImageUrl; // ä½¿ç”¨æ¨¡æ“¬åœ–ç‰‡æˆ–å¯¦éš› API å›å‚³çš„ URL
                
                loadingText.style.display = 'none';
                spotImage.style.display = 'block';
                
            } catch (error) {
                console.error("åœ–ç‰‡ç”Ÿæˆå¤±æ•—:", error);
                loadingText.textContent = `âŒ åœ–ç‰‡ç”Ÿæˆå¤±æ•—ã€‚è«‹æª¢æŸ¥ API æœå‹™ã€‚éŒ¯èª¤: ${error.message}`;
                loadingText.style.color = 'red';
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'âœ… åœ–ç‰‡ç”Ÿæˆå®Œæˆï¼';
                setTimeout(() => {
                    generateBtn.textContent = 'âœ¨ æ¨¡æ“¬ AI (Imagen) ç”Ÿæˆæ™¯é»åœ–ç‰‡';
                }, 2000);
            }
        }
    </script>
</body>
</html>
