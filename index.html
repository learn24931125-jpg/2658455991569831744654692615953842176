<H1>æ™ºæ…§æ—…éŠå°è¦½</H1>
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI æ™ºæ…§æ—…éŠå°è¦½ç³»çµ± - å°ç£ (è¡Œç¨‹è¦åŠƒ 2.0)</title>
    <style>
        /* Neumorphism æŸ”å’Œäºå…‹åŠ›é¢¨æ ¼è®Šæ•¸ */
        :root {
            --main-bg-color: #e0e5ec;
            --light-shadow: #ffffff;
            --dark-shadow: #a3b1c6;
            --text-color: #333;
            --accent-color: #4CAF50;  /* ç¶ è‰² (å•Ÿç¨‹åœ°) */
            --warning-color: #f44336; /* ç´…è‰² (ç›®çš„åœ°) */
            --info-color: #2196F3;    /* è—è‰² (è¦åŠƒæŒ‰éˆ•) */
            --border-radius: 12px;
            --padding-size: 20px;
        }

        /* åŸºç¤ä½ˆå±€èˆ‡ Neumorphism æ¨£å¼ (ç¶­æŒä¸è®Š) */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--main-bg-color); color: var(--text-color); margin: 0; padding: 0; }
        .container { max-width: 1400px; margin: 0 auto; padding: var(--padding-size); width: 100%; }
        .neumorphic-inset { /* å…§å‡¹ */
            border-radius: var(--border-radius); background: var(--main-bg-color);
            box-shadow: inset 6px 6px 12px var(--dark-shadow), inset -6px -6px 12px var(--light-shadow);
            padding: var(--padding-size); margin-bottom: var(--padding-size);
        }
        .neumorphic-outset { /* å¤–å‡¸ */
            border-radius: var(--border-radius); background: var(--main-bg-color);
            box-shadow: 6px 6px 12px var(--dark-shadow), -6px -6px 12px var(--light-shadow);
            padding: var(--padding-size); margin-bottom: var(--padding-size);
        }
        header { text-align: center; padding: 40px 0; box-shadow: 0 4px 8px var(--dark-shadow), 0 -4px 8px var(--light-shadow); margin-bottom: var(--padding-size); }
        .main-content { display: flex; gap: var(--padding-size); }
        .sidebar { width: 30%; min-width: 300px; display: flex; flex-direction: column; gap: var(--padding-size); }
        .main-panel { width: 70%; display: flex; flex-direction: column; gap: var(--padding-size); }
        
        /* è¼¸å…¥èˆ‡æ§åˆ¶é …æ¨£å¼ */
        .nav-button {
            border: none; padding: 10px 15px; border-radius: var(--border-radius); background: var(--main-bg-color);
            cursor: pointer; font-weight: bold; color: var(--text-color);
            box-shadow: 3px 3px 6px var(--dark-shadow), -3px -3px 6px var(--light-shadow);
            transition: all 0.2s ease;
        }
        .nav-button.active, .nav-button:active {
            box-shadow: inset 3px 3px 6px var(--dark-shadow), inset -3px -3px 6px var(--light-shadow);
            color: var(--accent-color);
        }
        .input-group { display: flex; align-items: center; margin-bottom: 10px; gap: 10px; }
        .input-group label { width: 70px; font-weight: bold; font-size: 0.9em; }
        .input-group input[type="text"], .input-group input[type="number"], .input-group select {
            flex-grow: 1; padding: 8px 12px; border: none; border-radius: 8px;
            background: var(--main-bg-color);
            box-shadow: inset 2px 2px 5px var(--dark-shadow), inset -2px -2px 5px var(--light-shadow);
        }
        
        /* æ—…éŠè¡Œç¨‹å±•ç¤ºå€ - å‡ç´šæ¨£å¼ */
        #itinerary-display {
            min-height: 150px; margin-top: 15px;
            border-radius: var(--border-radius); background: var(--main-bg-color);
            box-shadow: inset 4px 4px 8px var(--dark-shadow), inset -4px -4px 8px var(--light-shadow);
            padding: 15px; font-size: 0.95em;
        }
        #itinerary-display h4 {
            color: var(--info-color); border-bottom: 1px solid var(--dark-shadow);
            padding-bottom: 5px; margin-top: 0;
        }
        .day-plan {
            margin-bottom: 15px;
            padding: 10px;
            border-left: 3px solid var(--info-color);
            background: rgba(255, 255, 255, 0.5); /* æŸ”å’ŒèƒŒæ™¯ */
            border-radius: 5px;
        }
        .day-plan h5 { color: var(--text-color); margin: 0 0 5px 0; }
        .day-plan ul { list-style-type: none; padding-left: 0; }
        .day-plan li { margin-bottom: 5px; }
        .day-plan strong { color: var(--accent-color); }

        /* å¡ç‰‡æŒ‰éˆ•æ¨£å¼ (ç¶­æŒä¸è®Š) */
        .action-btn.origin { color: white; background-color: var(--accent-color); }
        .action-btn.destination { color: white; background-color: var(--warning-color); }
    </style>
</head>
<body>

    <header>
        <h1>ğŸ‡¹ğŸ‡¼ AI æ™ºæ…§æ—…éŠå°è¦½ç³»çµ±</h1>
        <p>è¦åŠƒå°ç£æœ€ä½³è·¯ç·šï¼Œç”Ÿæˆæ™¯é»ä»‹ç´¹èˆ‡åœ–ç‰‡</p>
    </header>

    <div class="container">
        <div class="api-settings neumorphic-inset">
            <label>API ç‹€æ…‹: <span id="api-status-text">æœªé©—è­‰</span> <span id="api-status-light" class="status-light invalid"></span></label>
            <label for="apiKey">Gemini API Key:</label>
            <input type="text" id="apiKey" placeholder="è¼¸å…¥æ‚¨çš„ Gemini API Key" />
            <select id="modelSelect" class="nav-button">
                <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
            </select>
            <button class="nav-button" onclick="checkApiKey()">é©—è­‰ Key</button>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <div class="trip-status neumorphic-outset">
                    <h3>ğŸ“ è¡Œç¨‹èµ·è¨–é»èˆ‡åå¥½è¨­å®š</h3>
                    
                    <div class="input-group">
                        <label for="input-origin" style="color:var(--accent-color)">å•Ÿç¨‹åœ°</label>
                        <input type="text" id="input-origin" placeholder="æ‰‹å‹•è¼¸å…¥æˆ–é»æ“Šå¡ç‰‡è¨­å®š" />
                    </div>
                    
                    <div class="input-group">
                        <label for="input-destination" style="color:var(--warning-color)">ç›®çš„åœ°</label>
                        <input type="text" id="input-destination" placeholder="æ‰‹å‹•è¼¸å…¥æˆ–é»æ“Šå¡ç‰‡è¨­å®š" />
                    </div>
                    
                    <div class="input-group">
                        <label for="travel-days">æ—…éŠå¤©æ•¸</label>
                        <input type="number" id="travel-days" value="3" min="1" max="14" style="width: 50px;" />
                    </div>
                    
                    <div class="input-group">
                        <label for="planning-style">è¦åŠƒåå¥½</label>
                        <select id="planning-style" style="flex-grow: 1;">
                            <option value="compact">ç·Šæ¹Šé«˜æ•ˆ (å¤šæ™¯é»)</option>
                            <option value="leisure" selected>æ‚ é–’æ”¾é¬† (æ·±åº¦éŠ)</option>
                            <option value="family">è¦ªå­å‹å–„</option>
                            <option value="culture">æ–‡åŒ–æ¢ç´¢</option>
                        </select>
                    </div>
                    
                    <button class="nav-button" id="start-planning-btn" style="width: 100%; background-color: var(--info-color); color: white; margin-top: 15px;">
                        ğŸš€ å•Ÿå‹• AI æ™ºæ…§è¦åŠƒ
                    </button>

                    <div id="itinerary-display">
                        <h4>AI æ—…éŠè¡Œç¨‹è¦åŠƒçµæœ</h4>
                        <p id="itinerary-text">è«‹è¨­å®šèµ·è¨–é»ã€å¤©æ•¸èˆ‡åå¥½ï¼Œé»æ“ŠæŒ‰éˆ•é–‹å§‹è¦åŠƒã€‚</p>
                    </div>
                </div>
                
                <div class="spot-menu neumorphic-outset">
                    <h3>ğŸ—ºï¸ æ™¯é»è³‡è¨Šèˆ‡åœ°åœ–</h3>
                    <div id="spot-info-display">è«‹é»æ“Šæ™¯é»å¡ç‰‡æŸ¥çœ‹è©³ç´°è³‡è¨Šã€‚</div>
                    <div id="map-display">åœ°åœ–å±•ç¤ºå€ï¼ˆå°‡æ¨¡æ“¬åº§æ¨™é¡¯ç¤ºï¼‰</div>
                </div>
            </div>

            <div class="main-panel">
                <h2>ç²¾é¸å°ç£æ™¯é»</h2>
                
                <div class="neumorphic-inset" style="padding: 10px;">
                    <ul class="menu-list" id="category-menu">
                        <li><button class="nav-button category-btn active" data-category="å…¨éƒ¨">å…¨éƒ¨æ™¯é»</button></li>
                        <li><button class="nav-button category-btn" data-category="å¤è¹Ÿ">æ­·å²å¤è¹Ÿ</button></li>
                        <li><button class="nav-button category-btn" data-category="è‡ªç„¶">è‡ªç„¶é¢¨å…‰</button></li>
                        <li><button class="nav-button category-btn" data-category="ç¾é£Ÿ">å¤œå¸‚ç¾é£Ÿ</button></li>
                        <li><button class="nav-button category-btn" data-category="æ–‡å‰µ">æ–‡å‰µåœ’å€</button></li>
                        <li><button class="nav-button category-btn" data-category="å…¶ä»–">å…¶ä»–</button></li>
                    </ul>
                </div>
                
                <div class="card-grid" id="spot-cards-container"></div>
            </div>
        </div>
    </div>

    <script>
        // æ™¯é»è³‡æ–™ (ç¶­æŒä¸è®Š)
        const SPOTS_DATA = [
            { id: 1, name: "æ•…å®®åšç‰©é™¢", description: "ğŸ›ï¸ å…¨çƒä¸­è¯æ–‡åŒ–è—è¡“å¯¶è—ã€‚", location: "å°åŒ—å£«æ—", category: "å¤è¹Ÿ", coords: { lat: 25.1018, lng: 121.5489 }, image: null },
            { id: 2, name: "å®‰å¹³å¤å ¡", description: "ğŸ° å°ç£æ­·å²æœ€æ‚ ä¹…çš„åŸå ¡ä¹‹ä¸€ï¼ŒåŸåç†±è˜­é®åŸã€‚", location: "å°å—å®‰å¹³", category: "å¤è¹Ÿ", coords: { lat: 23.0011, lng: 120.1650 }, image: null },
            { id: 3, name: "ç´…æ¯›åŸ", description: "ğŸ‡¬ğŸ‡§ æ­·å²æ‚ ä¹…çš„è¥¿ç­ç‰™ã€è·è˜­ã€è‹±åœ‹éºè·¡ã€‚", location: "æ–°åŒ—æ·¡æ°´", category: "å¤è¹Ÿ", coords: { lat: 25.1754, lng: 121.4329 }, image: null },
            { id: 4, name: "æ—¥æœˆæ½­", description: "ğŸï¸ å°ç£ä¸­éƒ¨æœ€ç¾çš„é«˜å±±æ¹–æ³Šï¼Œæ™¯è‰²å®œäººã€‚", location: "å—æŠ•é­šæ± ", category: "è‡ªç„¶", coords: { lat: 23.8581, lng: 120.9185 }, image: null },
            { id: 5, name: "å¤ªé­¯é–£åœ‹å®¶å…¬åœ’", description: "â›°ï¸ é›„å‰å£¯éº—çš„å³½è°·æ™¯è§€ï¼Œä¸–ç•Œç´šçš„è‡ªç„¶å¥‡è§€ã€‚", location: "èŠ±è“®ç§€æ—", category: "è‡ªç„¶", coords: { lat: 24.1822, lng: 121.6111 }, image: null },
            { id: 6, name: "é˜¿é‡Œå±±åœ‹å®¶æ£®æ—éŠæ¨‚å€", description: "ğŸŒ² æ—¥å‡ºã€é›²æµ·ã€æ™šéœã€æ£®æ—åŠé«˜å±±éµè·¯ã€‚", location: "å˜‰ç¾©é˜¿é‡Œå±±", category: "è‡ªç„¶", coords: { lat: 23.5103, lng: 120.8061 }, image: null },
            { id: 7, name: "å£«æ—å¤œå¸‚", description: "ğŸœ å°åŒ—æœ€å¤§ã€æœ€çŸ¥åçš„è§€å…‰å¤œå¸‚ï¼Œç¾é£Ÿé›²é›†ã€‚", location: "å°åŒ—å£«æ—", category: "ç¾é£Ÿ", coords: { lat: 25.0886, lng: 121.5244 }, image: null },
            { id: 8, name: "å…­åˆå¤œå¸‚", description: "ğŸ¦ é«˜é›„å¸‚æœ€å…·ä»£è¡¨æ€§çš„å¤œå¸‚ï¼Œä»¥æµ·é®®èåã€‚", location: "é«˜é›„æ–°èˆˆ", category: "ç¾é£Ÿ", coords: { lat: 22.6330, lng: 120.3022 }, image: null },
            { id: 9, name: "æ–‡åŒ–è·¯å¤œå¸‚", description: "ğŸ² å˜‰ç¾©ä»£è¡¨æ€§çš„ç¾é£Ÿè¡—ï¼Œé›è‚‰é£¯ç™¼æºåœ°ã€‚", location: "å˜‰ç¾©è¥¿å€", category: "ç¾é£Ÿ", coords: { lat: 23.4792, lng: 120.4497 }, image: null },
            { id: 10, name: "è¯å±±1914æ–‡å‰µåœ’å€", description: "ğŸ¨ èˆŠé…’å» æ”¹å»ºï¼Œå……æ»¿è—æ–‡æ°£æ¯çš„å±•è¦½ç©ºé–“ã€‚", location: "å°åŒ—ä¸­æ­£", category: "æ–‡å‰µ", coords: { lat: 25.0444, lng: 121.5293 }, image: null },
            { id: 11, name: "æ¾å±±æ–‡å‰µåœ’å€", description: "ğŸ¢ å‰èº«ç‚ºè¸å» ï¼Œç¾åœ¨æ˜¯è¨­è¨ˆå±•è¦½çš„ç†±é–€åœ°é»ã€‚", location: "å°åŒ—ä¿¡ç¾©", category: "æ–‡å‰µ", coords: { lat: 25.0436, lng: 121.5625 }, image: null },
            { id: 12, name: "é§äºŒè—è¡“ç‰¹å€", description: "ğŸ­ æ¸¯å£å€‰åº«æ”¹å»ºçš„è—æ–‡ç‰¹å€ï¼Œå……æ»¿æµ·æ´‹é¢¨æƒ…ã€‚", location: "é«˜é›„é¹½åŸ•", category: "æ–‡å‰µ", coords: { lat: 22.6226, lng: 120.2878 }, image: null },
            { id: 13, name: "å°åŒ— 101 è§€æ™¯å°", description: "ğŸ™ï¸ å°ç£åœ°æ¨™ï¼Œå¯ä¿¯ç°æ•´å€‹å°åŒ—éƒ½æœƒå€ã€‚", location: "å°åŒ—ä¿¡ç¾©", category: "å…¶ä»–", coords: { lat: 25.0336, lng: 121.5647 }, image: 'https://picsum.photos/400/200?random=13' },
            { id: 14, name: "åœ‹ç«‹æµ·æ´‹ç”Ÿç‰©åšç‰©é¤¨", description: "ğŸ  å°ç£æœ€å¤§æ°´æ—é¤¨ï¼Œå¯å¤œå®¿çš„æµ·æ´‹ä¸–ç•Œã€‚", location: "å±æ±è»ŠåŸ", category: "å…¶ä»–", coords: { lat: 22.0461, lng: 120.6989 }, image: null },
        ];

        let currentCategory = 'å…¨éƒ¨';

        // --- API Key é©—è­‰ (ç¶­æŒä¸è®Š) ---
        function checkApiKey() {
            const apiKeyInput = document.getElementById('apiKey').value.trim();
            const statusLight = document.getElementById('api-status-light');
            const statusText = document.getElementById('api-status-text');

            if (apiKeyInput.length > 20 && apiKeyInput.startsWith('AIza')) { 
                statusLight.classList.remove('invalid');
                statusLight.classList.add('valid');
                statusText.innerText = 'å·²é€£ç·š (æ¨¡æ“¬)';
                alert('API Key é©—è­‰æˆåŠŸï¼ (æ¨¡æ“¬åŠŸèƒ½)');
            } else {
                statusLight.classList.remove('valid');
                statusLight.classList.add('invalid');
                statusText.innerText = 'ç„¡æ•ˆ Key';
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„ Key ä»¥å•Ÿç”¨ AI åŠŸèƒ½ã€‚');
            }
        }
        
        // --- é¡¯ç¤ºæ™¯é»è©³æƒ… (ç¶­æŒä¸è®Š) ---
        function showSpotDetails(spotId) {
            const spot = SPOTS_DATA.find(s => s.id === spotId);
            if (!spot) return;
            const infoDisplay = document.getElementById('spot-info-display');
            const mapDisplay = document.getElementById('map-display');
            
            infoDisplay.innerHTML = `
                <h4>âœ¨ ${spot.name} (${spot.category})</h4>
                <p style="font-size:0.95em; color:var(--text-color);">${spot.description}</p>
                <p style="margin: 5px 0;"><strong>ğŸ“ ä½ç½®:</strong> ${spot.location}</p>
                <p style="margin: 5px 0;"><strong>ğŸŒ åº§æ¨™:</strong> Lat: ${spot.coords.lat.toFixed(4)}, Lng: ${spot.coords.lng.toFixed(4)}</p>
            `;
            mapDisplay.innerHTML = `<div style="text-align: center;"><strong>[æ¨¡æ“¬åœ°åœ–]</strong><br>æ™¯é»ï¼š${spot.name}<br>ä¸­å¿ƒé»ï¼š${spot.coords.lat.toFixed(2)}, ${spot.coords.lng.toFixed(2)}</div>`;
            infoDisplay.scrollIntoView({ behavior: 'smooth' });
        }
        
        // --- æ¨¡æ“¬åœ–ç‰‡ç”Ÿæˆ (ç¶­æŒä¸è®Š) ---
        function simulateImageGeneration(event, spotId) {
            event.stopPropagation();
            const card = document.querySelector(`.spot-card[data-id="${spotId}"]`);
            if (!card) return;
            // ... (æ¨¡æ“¬åœ–ç‰‡ç”Ÿæˆé‚è¼¯)
            alert('AI åœ–ç‰‡ç”Ÿæˆè«‹æ±‚å·²ç™¼é€ (æ¨¡æ“¬)ã€‚');
        }

        // --- é»æ“Šå¡ç‰‡è¨­å®šå•Ÿç¨‹åœ°æˆ–ç›®çš„åœ° (ç¶­æŒä¸è®Š) ---
        function setWaypoint(event, spotId, type) {
            event.stopPropagation();
            const spot = SPOTS_DATA.find(s => s.id === spotId);
            if (!spot) return;
            
            const inputElement = document.getElementById(`input-${type}`);
            const waypointName = spot.name + ' (' + spot.location + ')';

            document.querySelectorAll('.action-btn.origin').forEach(btn => btn.classList.remove('origin'));
            document.querySelectorAll('.action-btn.destination').forEach(btn => btn.classList.remove('destination'));

            inputElement.value = waypointName;
            event.target.classList.add(type);
            
            alert(`å·²å°‡æ™¯é»ã€Œ${spot.name}ã€è¨­ç‚ºæ‚¨çš„${type === 'origin' ? 'å•Ÿç¨‹åœ°' : 'ç›®çš„åœ°'}ï¼Œä¸¦åŒæ­¥è‡³è¼¸å…¥æ¡†ã€‚`);
        }
        
        // --- æ™¯é»åˆ†é¡ç¯©é¸åŠŸèƒ½ (ç¶­æŒä¸è®Š) ---
        function filterSpots(category) {
            currentCategory = category;
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.category === category) { btn.classList.add('active'); }
            });
            renderSpotCards();
        }

        // --- 6. AI è‡ªå‹•è¦åŠƒè·¯ç·šåŠŸèƒ½ (æ ¸å¿ƒå‡ç´š) ---
        function startRoutePlanning() {
            const origin = document.getElementById('input-origin').value.trim();
            const destination = document.getElementById('input-destination').value.trim();
            const days = parseInt(document.getElementById('travel-days').value);
            const style = document.getElementById('planning-style').value;
            const itineraryDisplay = document.getElementById('itinerary-text');
            const apiStatus = document.getElementById('api-status-light').classList.contains('valid');

            if (!apiStatus) {
                alert('ğŸš¨ è­¦å‘Šï¼šè«‹å…ˆé©—è­‰ API Key æ‰èƒ½ä½¿ç”¨ AI è¦åŠƒåŠŸèƒ½ï¼');
                return;
            }

            if (!origin || !destination) {
                alert('è«‹è¼¸å…¥æˆ–é»é¸è¨­å®šå•Ÿç¨‹åœ°èˆ‡ç›®çš„åœ°ï¼');
                return;
            }
            if (days < 1 || days > 14) {
                alert('è«‹è¼¸å…¥åˆç†çš„æ—…éŠå¤©æ•¸ (1-14å¤©)ã€‚');
                return;
            }
            
            // é¡¯ç¤ºè¦åŠƒä¸­ç‹€æ…‹
            itineraryDisplay.innerHTML = `<p style="color:var(--info-color); font-weight:bold; margin-bottom: 10px;">
                AI æ­£åœ¨åˆ†ææ‚¨çš„ã€${days}å¤© ${getStyleName(style)}ã€‘è¡Œç¨‹ï¼Œå¾ã€Œ${origin}ã€åˆ°ã€Œ${destination}ã€...
            </p>`;
            
            // æ¨¡æ“¬ AI è¦åŠƒè¡Œç¨‹çš„å»¶é²å’Œçµæœ
            setTimeout(() => {
                const simulatedItinerary = generateSimulatedItinerary(origin, destination, days, style);
                document.getElementById('itinerary-display').innerHTML = `
                    <h4>âœ… AI æ™ºæ…§è¦åŠƒçµæœ (å…± ${days} å¤©)</h4>
                    ${simulatedItinerary}
                    <p style="font-size: 0.85em; color: var(--accent-color); margin-top: 10px;">
                        ğŸ’¡ è·¯ç·šè¦åŠƒèˆ‡æ™‚é–“ä¼°ç®—å·²åŒæ­¥è‡³åœ°åœ–å±•ç¤ºå€ï¼(æ¨¡æ“¬)
                    </p>
                `;
                
                // æ›´æ–°åœ°åœ–å±•ç¤ºå€ï¼ˆæ¨¡æ“¬è·¯ç·šæ¨™è¨˜ï¼‰
                document.getElementById('map-display').innerHTML = `
                    <div style="text-align: center;">
                        <strong>[æ¨¡æ“¬åœ°åœ–è·¯ç·š]</strong><br>
                        é¡¯ç¤ºã€${days}å¤©ã€‘çš„å»ºè­°è·¯å¾‘èˆ‡æ™¯é»æ¨™è¨˜ã€‚
                    </div>
                `;

            }, 2500); // æ¨¡æ“¬ 2.5 ç§’çš„è¦åŠƒæ™‚é–“
        }
        
        // è¼”åŠ©å‡½æ•¸ï¼šæ ¹æ“šåå¥½å€¼ç²å–ä¸­æ–‡åç¨±
        function getStyleName(style) {
            switch(style) {
                case 'compact': return 'ç·Šæ¹Šé«˜æ•ˆ';
                case 'leisure': return 'æ‚ é–’æ”¾é¬†';
                case 'family': return 'è¦ªå­å‹å–„';
                case 'culture': return 'æ–‡åŒ–æ¢ç´¢';
                default: return 'æ¨™æº–';
            }
        }
        
        // è¼”åŠ©å‡½æ•¸ï¼šç”Ÿæˆçµæ§‹åŒ–çš„æ¨¡æ“¬è¡Œç¨‹çµæœ
        function generateSimulatedItinerary(origin, destination, days, style) {
            let html = '';
            
            // æ¨¡æ“¬æ ¹æ“šåå¥½é¸æ“‡çš„æ™¯é»
            const getRandomSpot = (exclude) => {
                const available = SPOTS_DATA.filter(s => s.name !== origin && s.name !== destination && s.category !== exclude);
                return available[Math.floor(Math.random() * available.length)];
            };

            for (let day = 1; day <= days; day++) {
                const spot1 = getRandomSpot(style === 'culture' ? 'ç¾é£Ÿ' : null);
                const spot2 = getRandomSpot(style === 'leisure' ? 'ç¾é£Ÿ' : null);
                const isFoodDay = style === 'compact' && Math.random() < 0.5;

                let activities = [];

                if (day === 1) {
                    activities.push(`å¾ **${origin}** å•Ÿç¨‹ï¼Œå‰å¾€ç¬¬ä¸€å€‹ä¸»è¦åŸå¸‚ã€‚`);
                    activities.push(`ä¸­é¤ï¼šæ¨è–¦åœ¨ ${spot1.location} äº«ç”¨ç•¶åœ°ç‰¹è‰²ã€‚`);
                    activities.push(`ä¸‹åˆï¼šåƒè§€ ${spot1.name} (${spot1.category})ã€‚`);
                    if (style !== 'leisure') activities.push(`æ™šé¤/å¤œé–“ï¼šè½‰å¾€ ${spot2.location} é™„è¿‘çš„å¤œå¸‚ã€‚`);
                } else if (day === days) {
                    activities.push(`ä¸Šåˆï¼šé€²è¡Œæœ€å¾Œä¸€é …æ´»å‹•ï¼Œåƒè§€ ${spot2.name} (${spot2.category})ã€‚`);
                    activities.push(`ä¸‹åˆï¼šé–‹å§‹è¿”ç¨‹ï¼Œå‰å¾€çµ‚é» **${destination}**ã€‚`);
                    activities.push('è¡Œç¨‹ç¸½çµèˆ‡å›é¡§ã€‚');
                } else {
                    if (style === 'leisure') {
                        activities.push(`å…¨æ—¥æ‚ é–’ï¼šæ·±åº¦é«”é©— ${spot1.name} (${spot1.location})ï¼Œå®‰æ’è¶³å¤ çš„ä¼‘æ¯æ™‚é–“ã€‚`);
                    } else if (style === 'compact') {
                        activities.push(`ä¸Šåˆï¼šå‰å¾€ ${spot1.name} (${spot1.category})ï¼Œä¸¦æ–¼ ${spot1.location} å‘¨é‚Šåˆé¤ã€‚`);
                        activities.push(`ä¸‹åˆï¼šå¿«é€Ÿç§»å‹•è‡³ ${spot2.name} (${spot2.category})ï¼Œç›¡é‡å¤šè·‘æ™¯é»ã€‚`);
                        if (isFoodDay) activities.push(`å¤œé–“ï¼šå°ˆæ”»ç¾é£Ÿï¼æ¢è¨ªéš±è—ç‰ˆå··å¼„å°åƒã€‚`);
                    } else { // family/culture
                        activities.push(`ä¸Šåˆï¼šåƒè§€ ${spot1.name} (${spot1.category})ï¼Œè‘—é‡æ·±åº¦å°è¦½æˆ–äº’å‹•è¨­æ–½ã€‚`);
                        activities.push(`ä¸‹åˆï¼šå‰å¾€ ${spot2.name} (${spot2.category})ã€‚`);
                    }
                }

                html += `
                    <div class="day-plan">
                        <h5>ğŸ“… Day ${day}ï¼š${day === 1 ? 'å•Ÿç¨‹æ—¥' : day === days ? 'è¿”ç¨‹æ—¥' : 'æ¢ç´¢æ—¥'}</h5>
                        <ul>
                            ${activities.map(act => `<li>${act.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }
            
            return html;
        }


        // --- æ™¯é»å¡ç‰‡å‹•æ…‹ç”Ÿæˆèˆ‡æ¸²æŸ“ (ç¶­æŒä¸è®Š) ---
        function renderSpotCards() {
            const container = document.getElementById('spot-cards-container');
            container.innerHTML = ''; 

            const filteredSpots = currentCategory === 'å…¨éƒ¨'
                ? SPOTS_DATA
                : SPOTS_DATA.filter(spot => spot.category === currentCategory);

            if (filteredSpots.length === 0) {
                container.innerHTML = `<p style="text-align:center; padding: 50px;" class="neumorphic-inset">æ­¤é¡åˆ¥æš«ç„¡æ™¯é»è³‡æ–™ã€‚</p>`;
                return;
            }

            filteredSpots.forEach(spot => {
                const card = document.createElement('div');
                card.className = 'spot-card';
                card.dataset.id = spot.id;
                card.onclick = () => showSpotDetails(spot.id);

                const imageStyle = spot.image ? `background-image: url('${spot.image}'); color: transparent;` : '';
                const imageContent = spot.image ? '' : `
                    AI ç”Ÿæˆæ™¯é»åœ–ç‰‡
                    <button class="action-btn nav-button" style="background-color: var(--info-color); color: white;" onclick="simulateImageGeneration(event, ${spot.id})">ç”Ÿæˆåœ–ç‰‡</button>
                `;

                card.innerHTML = `
                    <div class="card-image-placeholder" style="${imageStyle}">
                        ${imageContent}
                    </div>
                    <div class="card-content">
                        <h3>${spot.name}</h3>
                        <p style="font-size: 0.9em; margin-bottom: 5px;">${spot.description}</p>
                        <p style="font-size: 0.8em; color: #666;">åœ°é»: ${spot.location}</p>
                        <div class="card-actions">
                            <button class="action-btn" onclick="setWaypoint(event, ${spot.id}, 'origin')">è¨­ç‚ºå•Ÿç¨‹åœ°</button>
                            <button class="action-btn" onclick="setWaypoint(event, ${spot.id}, 'destination')">è¨­ç‚ºç›®çš„åœ°</button>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾ŒåŸ·è¡Œ
        document.addEventListener('DOMContentLoaded', () => {
            renderSpotCards();
            
            // ç‚ºåˆ†é¡æŒ‰éˆ•æ·»åŠ äº‹ä»¶ç›£è½å™¨
            document.querySelectorAll('.category-btn').forEach(button => {
                button.addEventListener('click', function() {
                    filterSpots(this.dataset.category);
                });
            });

            // ç‚ºè·¯ç·šè¦åŠƒæŒ‰éˆ•æ·»åŠ äº‹ä»¶
            document.getElementById('start-planning-btn').addEventListener('click', startRoutePlanning);
        });

    </script>
</body>
</html>
