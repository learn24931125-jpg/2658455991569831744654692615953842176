<H1>智慧旅遊導覽</H1>
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 智慧旅遊導覽系統 - 柔和亞克力 (Neumorphism) - 互動版</title>
    <style>
        /* CSS 保持不變，與上一個回答相同，確保 Neumorphism 風格 */
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Noto+Sans+TC:wght@300;500&display=swap');

        :root {
            --bg-color: #E0E5EC;
            --light-shadow: #FFFFFF;
            --dark-shadow: #A3B1C6;
            --main-text: #6D7D9A;
            --accent-color: #4B7BEC;
            --accent-light: #6A99FF;
            --accent-dark: #3759A3;
            --component-color: #E0E5EC;
            --border-radius: 15px;
            --success-color: #4CAF50; /* 新增成功色 */
            --error-color: #F44336;   /* 新增錯誤色 */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Noto Sans TC', 'Quicksand', sans-serif;
            color: var(--main-text);
        }

        body {
            background-color: var(--bg-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 30px;
        }

        /* 核心：柔和亞克力 (Neumorphism) 浮起效果 */
        .neumorphic-float {
            background: var(--component-color);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 
                8px 8px 16px var(--dark-shadow),
                -8px -8px 16px var(--light-shadow);
            transition: all 0.3s ease;
        }
        /* 點擊浮起元件時的互動效果 */
        .neumorphic-float:hover:not(.attraction-card) {
             box-shadow: 
                6px 6px 12px var(--dark-shadow),
                -6px -6px 12px var(--light-shadow);
        }

        /* 核心：柔和亞克力 (Neumorphism) 凹陷效果 */
        .neumorphic-concave {
            background: var(--component-color);
            border-radius: 10px;
            box-shadow: 
                inset 5px 5px 10px var(--dark-shadow),
                inset -5px -5px 10px var(--light-shadow);
            padding: 10px;
            transition: all 0.3s ease;
        }

        /* 標題區 (略) */
        .header {text-align: center; margin-bottom: 30px;}
        .header h1 {
            font-family: 'Quicksand', sans-serif; font-size: 2.5em;
            color: var(--accent-color); text-shadow: 2px 2px 4px var(--dark-shadow);
            margin-bottom: 5px;
        }

        /* 輸入框和下拉選單 (略) */
        .input-group input, .input-group select {
            width: 100%; border: none; background: none; outline: none;
            padding: 10px 15px; font-size: 1em; margin-top: 5px;
        }
        
        /* 應用凹陷效果到輸入欄位 */
        .input-wrapper {
            background: var(--component-color);
            border-radius: 10px;
            box-shadow: 
                inset 3px 3px 6px var(--dark-shadow), 
                inset -3px -3px 6px var(--light-shadow);
            padding: 5px;
            position: relative; /* 用於放置驗證圖標 */
        }
        
        .input-wrapper input:focus {
            box-shadow: 
                inset 3px 3px 6px var(--accent-dark), 
                inset -3px -3px 6px var(--accent-light);
        }
        
        /* 按鈕樣式 (略) */
        .neumorphic-button {
            background: var(--component-color); border: none; border-radius: 10px;
            padding: 10px 20px; font-size: 1em; font-weight: 600; cursor: pointer;
            box-shadow: 5px 5px 10px var(--dark-shadow), -5px -5px 10px var(--light-shadow);
            color: var(--accent-color); transition: all 0.2s ease;
        }

        .neumorphic-button:hover {
            color: var(--main-text);
            box-shadow: 3px 3px 6px var(--dark-shadow), -3px -3px 6px var(--light-shadow);
        }
        
        .neumorphic-button:active {
            box-shadow: inset 5px 5px 10px var(--dark-shadow), inset -5px -5px 10px var(--light-shadow);
            color: var(--main-text);
        }
        
        /* 驗證圖標樣式 */
        .validation-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .validation-icon.success { background-color: var(--success-color); color: white; }
        .validation-icon.error { background-color: var(--error-color); color: white; }

        /* API 設定區 (略) */
        .api-settings {display: flex; gap: 20px;}
        .input-group {flex: 1;}

        /* 國家選單區 (略) */
        .controls {display: flex; gap: 20px; align-items: center;}
        .controls label {white-space: nowrap;}

        /* 佈局容器 (略) */
        .main-content {display: grid; grid-template-columns: 2fr 1fr; gap: 30px;}
        .attraction-list h2 {color: var(--main-text); margin-bottom: 20px; font-family: 'Quicksand', sans-serif;}

        /* 景點卡片區 */
        .attraction-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            min-height: 400px; /* 確保在無內容時仍有空間 */
            align-content: start; /* 內容置頂 */
        }
        
        /* 景點卡片特殊樣式 (可點擊) */
        .attraction-card {
            cursor: pointer; /* 增加可點擊提示 */
        }
        .attraction-card.active {
            /* 被選中時呈現凹陷效果 */
            box-shadow: 
                inset 5px 5px 10px var(--dark-shadow),
                inset -5px -5px 10px var(--light-shadow);
            background-color: #DDE5F0; /* 略微變色 */
        }

        .card-image {
            width: 100%; height: 180px; margin-bottom: 10px;
            display: flex; align-items: center; justify-content: center;
            font-style: italic; font-size: 0.9em; background: var(--component-color);
            border-radius: 10px;
            box-shadow: inset 3px 3px 6px var(--dark-shadow), inset -3px -3px 6px var(--light-shadow);
            overflow: hidden;
        }

        /* 圖片佔位符文本樣式 */
        .card-image span {
            color: var(--main-text);
            padding: 10px;
            text-align: center;
        }

        .card-image img {
            width: 100%; height: 100%; object-fit: cover;
            border-radius: 10px;
        }

        /* 地圖展示區 */
        .map-frame {
            height: 400px; padding: 20px;
            /* 地圖框使用凹陷效果，模擬嵌入式螢幕 (已在上面定義) */
            box-shadow: inset 10px 10px 20px var(--dark-shadow), inset -10px -10px 20px var(--light-shadow);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: 600; font-size: 1.1em; text-align: center;
        }
        .map-frame p { margin-bottom: 5px; }

        /* 響應式設計 (略) */
        @media (max-width: 1024px) {
            .main-content {grid-template-columns: 1fr;}
            .api-settings {flex-direction: column;}
            .map-display {order: -1;}
        }
    </style>
</head>
<body>

    <header class="header">
        <h1>AI 智慧旅遊導覽系統</h1>
        <p>Soft Acrylic Interface for Immersive Travel</p>
    </header>

    <div class="api-settings neumorphic-float">
        <div class="input-group">
            <label for="ai-key">Gemini API Key (景點介紹/圖片生成)</label>
            <div class="input-wrapper">
                <input type="password" id="ai-key" placeholder="輸入您的 Gemini API Key" oninput="validateApiKey('ai-key', 'ai-validation')">
                <div id="ai-validation" class="validation-icon" style="display: none;"></div>
            </div>
        </div>
        <div class="input-group">
            <label for="map-key">Map Key (地圖顯示)</label>
            <div class="input-wrapper">
                <input type="password" id="map-key" placeholder="輸入您的地圖 API Key" oninput="validateApiKey('map-key', 'map-validation')">
                <div id="map-validation" class="validation-icon" style="display: none;"></div>
            </div>
        </div>
    </div>

    <div class="controls neumorphic-float">
        <label for="country-select">選擇國家/地區:</label>
        <div class="input-group" style="flex: 1;">
            <div class="input-wrapper">
                <select id="country-select">
                    <option value="" selected disabled>請選擇</option>
                    <option value="japan">日本</option>
                    <option value="korea">韓國</option>
                    <option value="taiwan">台灣</option>
                    <option value="usa">美國</option>
                </select>
            </div>
        </div>
        <button class="neumorphic-button" id="generate-attractions-btn" disabled>生成推薦景點</button>
    </div>

    <div class="main-content">
        <div class="attraction-list">
            <h2 id="attraction-title">景點卡片區 (請先選擇國家)</h2>
            <div class="attraction-cards" id="attraction-cards-container">
                <p style="text-align: center; margin-top: 50px;">點擊上方「生成推薦景點」按鈕後，AI 推薦的景點將顯示在此處。</p>
            </div>
        </div>
        
        <div class="map-display">
            <h2 id="map-title">地圖展示區</h2>
            <div class="map-frame" id="map-frame">
                <p id="map-info-name" style="color: var(--accent-color); font-size: 1.5em; margin-bottom: 20px;">AI 導覽地圖</p>
                <p id="map-info-desc">點擊左側景點卡片，在地圖區查看詳細資訊和模擬座標。</p>
                <p id="map-info-coords" style="font-size: 0.9em; margin-top: 15px;">模擬座標：N/A, E/A</p>
                <p id="map-api-placeholder" style="font-size: 0.7em; margin-top: 10px; color: var(--main-text); opacity: 0.7;">(此處為地圖 API 顯示區域)</p>
            </div>
        </div>
    </div>

<script>
    // =========================================================
    // 模擬數據庫 (實際應用中應由 Gemini API 生成)
    // =========================================================
    const MOCK_ATTRACTIONS = {
        japan: [
            { id: 1, name: "東京晴空塔", description: "高聳入雲的廣播塔，是東京的新地標，能俯瞰整個關東平原。", lat: 35.71, lon: 139.81 },
            { id: 2, name: "伏見稻荷大社", description: "京都的代表性神社，以綿延不絕的朱紅色「千本鳥居」聞名。", lat: 34.96, lon: 135.77 },
            { id: 3, name: "嚴島神社", description: "位於海上，以「海上鳥居」聞名的世界遺產，潮汐景觀迷人。", lat: 34.29, lon: 132.32 }
        ],
        taiwan: [
            { id: 4, name: "台北101", description: "曾是世界第一高樓，設計融入竹子節節高升的意象，是台灣的代表性建築。", lat: 25.03, lon: 121.56 },
            { id: 5, name: "太魯閣國家公園", description: "壯麗的大理石峽谷景觀，涵蓋高山到海洋多樣生態，是世界級的自然奇觀。", lat: 24.16, lon: 121.63 },
            { id: 6, name: "日月潭", description: "台灣最大的天然湖泊，湖光山色迷人，以拉魯島為界分為日潭與月潭。", lat: 23.83, lon: 120.91 }
        ],
        korea: [
            { id: 7, name: "景福宮", description: "朝鮮王朝的正宮，是韓國五大宮闕中規模最大、建築最美的。", lat: 37.58, lon: 126.97 },
            { id: 8, name: "釜山海雲台", description: "韓國最著名的海灘之一，以美麗的海岸線和夏日祭典聞名。", lat: 35.16, lon: 129.13 }
        ],
        usa: [
            { id: 9, name: "大峽谷國家公園", description: "科羅拉多河沖刷形成的巨大峽谷，擁有令人驚嘆的岩層和地質景觀。", lat: 36.10, lon: -112.11 },
            { id: 10, name: "自由女神像", description: "位於紐約港的自由島上，象徵自由與民主。", lat: 40.69, lon: -74.04 }
        ]
    };

    let selectedAttraction = null; // 儲存當前被選中的景點對象
    let apiKeysValid = { 'ai-key': false, 'map-key': false }; // 追蹤 Key 狀態

    // =========================================================
    // 1. API Key 驗證模擬
    // =========================================================
    const generateBtn = document.getElementById('generate-attractions-btn');

    /**
     * 模擬 API Key 驗證並更新視覺回饋
     * @param {string} inputId - 輸入框的 ID
     * @param {string} iconId - 驗證圖標的 ID
     */
    function validateApiKey(inputId, iconId) {
        const input = document.getElementById(inputId);
        const icon = document.getElementById(iconId);
        const value = input.value.trim();

        icon.style.display = 'flex';
        let isValid = false;

        // 模擬驗證邏輯：只要輸入長度大於 10 就算成功 (實際應發送 API 請求)
        if (value.length > 10) {
            icon.className = 'validation-icon success';
            icon.textContent = '✓';
            isValid = true;
        } else {
            icon.className = 'validation-icon error';
            icon.textContent = '✗';
        }
        
        // 更新 Key 狀態
        apiKeysValid[inputId] = isValid;

        // 檢查是否所有必要的 Key 都已驗證
        updateGenerateButtonState();
    }

    /**
     * 更新「生成推薦景點」按鈕的可點擊狀態
     */
    function updateGenerateButtonState() {
        const isReady = apiKeysValid['ai-key'] && apiKeysValid['map-key'] && document.getElementById('country-select').value !== "";
        generateBtn.disabled = !isReady;
        generateBtn.style.opacity = isReady ? 1 : 0.6;
    }
    
    // 監聽國家選單變化，更新按鈕狀態
    document.getElementById('country-select').addEventListener('change', updateGenerateButtonState);


    // =========================================================
    // 2. & 3. 國家選擇與動態生成景點
    // =========================================================
    
    document.getElementById('generate-attractions-btn').addEventListener('click', () => {
        const countrySelect = document.getElementById('country-select');
        const selectedCountry = countrySelect.value;
        const container = document.getElementById('attraction-cards-container');
        const countryText = countrySelect.options[countrySelect.selectedIndex].text;

        // 1. 清空舊卡片
        container.innerHTML = '';
        document.getElementById('attraction-title').textContent = `${countryText} 推薦景點 (AI 生成中...)`;

        // 2. 模擬 API 延遲
        setTimeout(() => {
            if (!selectedCountry || !MOCK_ATTRACTIONS[selectedCountry]) {
                container.innerHTML = `<p style="text-align: center; margin-top: 50px;">抱歉，找不到 ${countryText} 的景點數據。</p>`;
                document.getElementById('attraction-title').textContent = `景點卡片區 (選擇國家)`;
                return;
            }

            const attractions = MOCK_ATTRACTIONS[selectedCountry];
            
            // 3. 渲染新卡片
            attractions.forEach(attraction => {
                const card = createAttractionCard(attraction);
                container.appendChild(card);
            });

            document.getElementById('attraction-title').textContent = `${countryText} AI 推薦景點`;
            selectedAttraction = null; // 清除選中的景點
            updateMapDisplay(); // 清空地圖資訊
        }, 1000); // 模擬 1 秒 API 延遲
    });

    /**
     * 創建單個景點卡片 DOM 元素
     * @param {object} attraction - 景點數據對象
     * @returns {HTMLElement}
     */
    function createAttractionCard(attraction) {
        const card = document.createElement('div');
        card.className = 'attraction-card neumorphic-float';
        card.dataset.id = attraction.id;
        card.setAttribute('tabindex', 0); // 讓卡片可被聚焦

        card.innerHTML = `
            <h3>${attraction.name}</h3>
            <div class="card-image">
                <span>點擊「生成圖片」<br>呼叫 Gemini API 渲染 (Placeholder)</span>
            </div>
            <p class="card-description">
                ${attraction.description}
            </p>
            <div class="card-actions" style="display: flex; gap: 10px;">
                <button class="neumorphic-button" style="flex: 1;" onclick="handleVoicePlayback(event, ${attraction.id})">播放語音導覽</button>
                <button class="neumorphic-button" style="flex: 1;" onclick="handleImageGeneration(event, ${attraction.id})">生成圖片</button>
            </div>
        `;
        
        // 4. 點擊卡片後顯示介紹與地圖座標
        card.addEventListener('click', (e) => {
             // 確保點擊按鈕時不會觸發卡片點擊事件
            if (e.target.closest('button')) return;
            
            // 找到所有卡片並移除 active 狀態
            document.querySelectorAll('.attraction-card').forEach(c => c.classList.remove('active'));
            
            // 給當前卡片 active 狀態
            card.classList.add('active');
            
            selectedAttraction = attraction;
            updateMapDisplay();
        });

        return card;
    }
    
    /**
     * 更新地圖展示區的內容
     */
    function updateMapDisplay() {
        const nameEl = document.getElementById('map-info-name');
        const descEl = document.getElementById('map-info-desc');
        const coordsEl = document.getElementById('map-info-coords');

        if (selectedAttraction) {
            nameEl.textContent = selectedAttraction.name;
            // 實際應用中，這段描述會透過地圖 API 渲染地圖
            descEl.innerHTML = `<strong>景點介紹:</strong> ${selectedAttraction.description.substring(0, 40)}...`;
            coordsEl.textContent = `模擬座標: N ${selectedAttraction.lat}° , E ${selectedAttraction.lon}°`;
            // 這裡可以呼叫 Map API 渲染地圖
        } else {
            nameEl.textContent = "AI 導覽地圖";
            descEl.textContent = "請點擊左側景點卡片，查看詳細資訊。";
            coordsEl.textContent = "模擬座標: N/A, E/A";
        }
    }


    // =========================================================
    // 5. 功能按鈕 (生成圖片與語音播放) 模擬
    // =========================================================
    
    /**
     * 模擬語音播放功能
     */
    function handleVoicePlayback(event, attractionId) {
        event.stopPropagation(); // 阻止事件冒泡到卡片點擊事件
        const attraction = findAttractionById(attractionId);
        
        alert(`▶️ 正在播放 ${attraction.name} 的語音導覽... \n\n[實際應用中，您會在這裡呼叫 TTS (Text-to-Speech) API，將景點描述轉換為音檔並播放。]`);
    }

    /**
     * 模擬圖片生成功能
     */
    function handleImageGeneration(event, attractionId) {
        event.stopPropagation(); // 阻止事件冒泡到卡片點擊事件
        const attraction = findAttractionById(attractionId);
        const card = event.target.closest('.attraction-card');
        const imageContainer = card.querySelector('.card-image');

        imageContainer.innerHTML = '<span>圖片生成中... 🤖</span>';

        // 實際應用中：
        // 1. 呼叫 Gemini Image Generation API (如 Imagen)
        // 2. 傳入 attraction.description 作為提示詞 (Prompt)
        // 3. 獲取圖片 URL
        
        // 模擬圖片生成延遲
        setTimeout(() => {
            // 模擬圖片 URL
            const mockImageUrl = `https://picsum.photos/seed/${attractionId}/280/180`;
            imageContainer.innerHTML = `<img src="${mockImageUrl}" alt="${attraction.name} - AI 生成圖片">`;
            alert(`✅ 成功為 ${attraction.name} 生成圖片！\n\n[實際圖片已載入 Placeholder Image]`);
        }, 2000); // 模擬 2 秒生成時間
    }
    
    /**
     * 輔助函數：根據 ID 查找景點
     */
    function findAttractionById(id) {
        for (const country in MOCK_ATTRACTIONS) {
            const attraction = MOCK_ATTRACTIONS[country].find(att => att.id === id);
            if (attraction) return attraction;
        }
        return null;
    }

    // 初始化檢查按鈕狀態
    document.addEventListener('DOMContentLoaded', () => {
        // 確保剛載入頁面時，按鈕是禁用的
        updateGenerateButtonState(); 
        
        // 初始狀態：Key 輸入框為空，顯示錯誤圖標
        validateApiKey('ai-key', 'ai-validation');
        validateApiKey('map-key', 'map-validation');
    });

</script>

</body>
</html>
