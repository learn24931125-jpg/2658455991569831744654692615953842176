<H1>æ™ºæ…§æ—…éŠå°è¦½</H1>
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taiwan AI Travel Guide | æ™ºæ…§å°è¦½ç³»çµ±</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>

    <style>
        #map { height: calc(100vh - 80px); z-index: 1; }
        .filter-btn.active { background-color: #2563eb; color: white; border-color: #2563eb; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
    </style>
</head>
<body class="bg-gray-50 font-sans">

    <header class="h-20 bg-white border-b flex justify-between items-center px-8 sticky top-0 z-50 shadow-sm">
        <div class="flex items-center gap-2">
            <span class="text-3xl">ğŸ‡¹ğŸ‡¼</span>
            <h1 class="text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                TaiwanAI Travel
            </h1>
        </div>
        <div class="flex gap-4 items-center text-sm font-medium">
            <div class="flex items-center gap-2 bg-green-50 text-green-700 px-3 py-1 rounded-full border border-green-200">
                <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                AI API å·²å°±ç·’
            </div>
            <button class="bg-gray-800 text-white px-5 py-2 rounded-lg hover:bg-gray-700 transition">ç®¡ç†è¡Œç¨‹</button>
        </div>
    </header>

    <main class="flex flex-col md:flex-row h-[calc(100vh-80px)]">
        
        <aside class="w-full md:w-[400px] flex flex-col border-r bg-white z-40">
            <div class="p-4 border-b flex gap-2 overflow-x-auto no-scrollbar bg-white">
                <button onclick="filterSites('all')" class="filter-btn active border px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition-all">å…¨éƒ¨</button>
                <button onclick="filterSites('nature')" class="filter-btn border px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition-all">ğŸŒ² è‡ªç„¶</button>
                <button onclick="filterSites('culture')" class="filter-btn border px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition-all">ğŸ›ï¸ æ–‡åŒ–</button>
                <button onclick="filterSites('food')" class="filter-btn border px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition-all">ğŸœ ç¾é£Ÿ</button>
            </div>

            <div id="card-container" class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">
                </div>

            <div class="p-4 border-t bg-gray-50">
                <button onclick="drawSmartRoute()" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl shadow-lg hover:bg-blue-700 transition-all flex justify-center items-center gap-2">
                    âœ¨ ä¸€éµ AI è¦åŠƒè·¯ç·š
                </button>
            </div>
        </aside>

        <section class="flex-1 relative">
            <div id="map"></div>
        </section>
    </main>

    <script>
        // 1. è³‡æ–™å®šç¾©
        const attractions = [
            { id: 1, name: "å°åŒ— 101", category: "culture", coords: [25.0339, 121.5644], img: "https://images.unsplash.com/photo-1552912811-56167bd8594e?auto=format&fit=crop&w=400&q=80", ai: "å»ºè­°å‚æ™šå‰å¾€ï¼Œå¯åŒæ™‚è§€è³å¤•é™½èˆ‡ç¹è¯å¤œæ™¯ã€‚" },
            { id: 2, name: "å¤ªé­¯é–£åœ‹å®¶å…¬åœ’", category: "nature", coords: [24.1594, 121.6215], img: "https://images.unsplash.com/photo-1621940173665-c34960333211?auto=format&fit=crop&w=400&q=80", ai: "å¤§è‡ªç„¶çš„é¬¼æ–§ç¥å·¥ï¼Œå»ºè­°å®‰æ’è‡³å°‘ 4 å°æ™‚æ·±åº¦éŠè¦½ã€‚" },
            { id: 3, name: "æ—¥æœˆæ½­", category: "nature", coords: [23.8517, 120.9220], img: "https://images.unsplash.com/photo-1571217691515-568853b190f8?auto=format&fit=crop&w=400&q=80", ai: "æ¸…æ™¨çš„éœ§æ°£æœ€å‹•äººï¼Œç’°æ¹–è‡ªè¡Œè»Šé“æ˜¯å…¨çƒå‰åç¾ã€‚" },
            { id: 4, name: "é¥’æ²³å¤œå¸‚", category: "food", coords: [25.0501, 121.5775], img: "https://images.unsplash.com/photo-1570533036814-724395420173?auto=format&fit=crop&w=400&q=80", ai: "èƒ¡æ¤’é¤…æ’éšŠé›–é•·ä½†å€¼å¾—ï¼Œé«”é©—å°ç£åœ°é“ç…™ç«æ°£ã€‚" }
        ];

        // 2. åˆå§‹åŒ–åœ°åœ–
        const map = L.map('map').setView([23.9738, 120.9820], 8);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap'
        }).addTo(map);

        let markerLayer = L.layerGroup().addTo(map);
        let routingControl = null;

        // 3. æ¸²æŸ“åŠŸèƒ½
        function renderCards(data) {
            const container = document.getElementById('card-container');
            if (data.length === 0) {
                container.innerHTML = `<div class="text-center py-20 text-gray-400">æ‰¾ä¸åˆ°ç›¸é—œæ™¯é»</div>`;
                return;
            }
            container.innerHTML = data.map(site => `
                <div onclick="zoomToSite(${site.coords[0]}, ${site.coords[1]})" class="group bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden hover:shadow-md transition-all cursor-pointer">
                    <img src="${site.img}" class="h-32 w-full object-cover group-hover:scale-105 transition-transform">
                    <div class="p-4">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="font-bold text-gray-800">${site.name}</h3>
                            <span class="text-[10px] bg-blue-100 text-blue-600 px-2 py-0.5 rounded">${site.category.toUpperCase()}</span>
                        </div>
                        <div class="bg-gray-50 p-2 rounded text-xs text-gray-500 italic">
                            <span class="text-blue-500 font-bold">âœ¨ AI:</span> ${site.ai}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderMarkers(data) {
            markerLayer.clearLayers();
            data.forEach(site => {
                const marker = L.marker(site.coords).addTo(markerLayer);
                marker.bindPopup(`<b>${site.name}</b><br>${site.category}`);
            });
        }

        // 4. äº’å‹•é‚è¼¯
        function filterSites(category) {
            // åˆ‡æ›æŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.innerText.toLowerCase().includes(category) || (category === 'all' && btn.innerText === 'å…¨éƒ¨'));
            });

            const filtered = category === 'all' ? attractions : attractions.filter(s => s.category === category);
            renderCards(filtered);
            renderMarkers(filtered);

            if (filtered.length > 0) {
                const bounds = L.latLngBounds(filtered.map(s => s.coords));
                map.fitBounds(bounds, { padding: [50, 50] });
            }
        }

        function zoomToSite(lat, lng) {
            map.flyTo([lat, lng], 14);
        }

        function drawSmartRoute() {
            if (routingControl) map.removeControl(routingControl);
            
            // è¦åŠƒå‰ 3 å€‹æ™¯é»ä½œç‚ºè·¯å¾‘
            const waypoints = attractions.slice(0, 3).map(s => L.latLng(s.coords[0], s.coords[1]));

            routingControl = L.Routing.control({
                waypoints: waypoints,
                lineOptions: { styles: [{ color: '#2563eb', weight: 5 }] },
                createMarker: () => null, // éš±è—é è¨­æ¨™è¨˜ï¼Œä½¿ç”¨æˆ‘å€‘çš„è‡ªè¨‚æ¨™è¨˜
                addWaypoints: false,
                draggableWaypoints: false
            }).addTo(map);
        }

        // åˆå§‹åŸ·è¡Œ
        filterSites('all');
    </script>
</body>
</html>
