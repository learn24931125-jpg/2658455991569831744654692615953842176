<H1>æ™ºæ…§æ—…éŠå°è¦½</H1>
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ™ºæ…§æ—…éŠå°è¦½ç³»çµ± - å°ç£ (Neumorphism)</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <style>
        /* ========================================= */
        /* CSS æ¨£å¼ (å„ªåŒ–ç‰ˆ Neumorphism) */
        /* ========================================= */
        :root {
            /* ä¸»é¡Œè‰²è®Šæ•¸ */
            --main-color: #e0e5ec; 
            --light-color: #ffffff;
            --dark-color: #a3b1c6; 
            --primary-color: #4CAF50; /* ç¶ è‰² */
            --accent-color: #007bff; /* è—è‰² */
            --error-color: #dc3545; /* ç´…è‰² */
            --success-color: #28a745; /* æˆåŠŸç¶  */
            --border-radius: 12px;

            /* Neumorphism é™°å½±åƒæ•¸ */
            --shadow-out: 7px 7px 15px var(--dark-color), -7px -7px 15px var(--light-color);
            --shadow-in: inset 5px 5px 10px var(--dark-color), inset -5px -5px 10px var(--light-color);
            --shadow-pressed: inset 3px 3px 7px var(--dark-color), inset -3px -3px 7px var(--light-color);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', 'Segoe UI', Tahoma, sans-serif;
        }

        body {
            background-color: var(--main-color);
            padding: 20px;
        }

        .container {
            display: grid;
            grid-template-columns: 280px 1fr; 
            grid-template-rows: auto 1fr; 
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* --- Neumorphism åŸºç¤æ¨£å¼ --- */

        .neumorphism-panel, .neumorphism-card {
            background: var(--main-color);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-out); 
            transition: all 0.3s ease;
        }

        .header-panel {
            grid-column: 1 / -1; 
            text-align: center;
            padding: 30px 20px;
        }

        .sidebar {
            grid-row: 2 / 3;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* è¼¸å…¥æ¡†å’Œé¸æ“‡æ¡† */
        .neumorphism-input, .neumorphism-select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: none;
            background: var(--main-color);
            border-radius: 8px;
            box-shadow: var(--shadow-in); 
            color: #333;
        }

        /* é¸å–®é …ç›® */
        .menu-list { list-style: none; padding: 0; }
        .neumorphism-item {
            display: block;
            text-decoration: none;
            color: #333;
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: var(--shadow-out); 
        }

        .neumorphism-item.active {
            box-shadow: var(--shadow-in); 
            color: var(--primary-color);
            font-weight: bold;
        }
        
        /* --- ä¸»è¦å…§å®¹å€ --- */

        .main-content {
            grid-column: 2 / 3;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .attraction-card {
            width: calc(50% - 10px); 
            display: flex;
            overflow: hidden;
            display: none; /* åˆå§‹ç‹€æ…‹ï¼Œç”± JS æ§åˆ¶é¡¯ç¤º */
            cursor: pointer;
        }
        
        /* æ–°å¢ï¼šè·¯ç·šçµæœé¡¯ç¤ºå€å¡Šæ¨£å¼ */
        #route-result-section {
            display: none; /* åˆå§‹éš±è—ï¼Œç”± JS æ§åˆ¶é¡¯ç¤º */
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-out);
            background-color: var(--main-color);
        }

        .route-message {
            margin-top: 15px;
            padding: 15px;
            font-size: 0.95em;
            border-radius: 8px;
            background: #f0f4f8;
            border: 1px solid #d8dee8;
        }

        .route-message h4 {
            color: var(--success-color);
            margin-bottom: 10px;
        }

        pre { 
            white-space: pre-wrap; 
            font-family: monospace; 
            line-height: 1.6;
            padding: 10px;
            background: #e0e5ec;
            border-radius: 6px;
            border: 1px solid var(--dark-color);
        }

        /* éŒ¯èª¤å’ŒåŠ è¼‰æç¤º */
        .route-message p[style*="color:var(--error-color)"] {
            font-weight: bold;
        }
    </style>
    </head>
<body>
    <div class="container">
        <header class="neumorphism-panel header-panel">
            <h1>ğŸ‡¹ğŸ‡¼ AIæ™ºæ…§æ—…éŠå°è¦½ç³»çµ±</h1>
            <p>é€é Gemini AI è¦åŠƒæ‚¨çš„å°ç£ä¹‹æ—…ï¼Œæ¢ç´¢ç²¾å½©æ™¯é»ã€‚</p>
        </header>

        <section class="api-settings neumorphism-panel">
            <h2>âš™ï¸ API è¨­å®šå€</h2>
            <div class="input-group">
                <label for="gemini-key">Gemini API Key:</label>
                <input type="password" id="gemini-key" placeholder="è¼¸å…¥æ‚¨çš„API Key" class="neumorphism-input">
                <p id="api-status" style="font-size: 0.9em; margin-top: 5px;"></p>
            </div>
            <button id="verify-api-btn" class="neumorphism-button primary-button">é©—è­‰ä¸¦ä¿å­˜è¨­å®š</button>
        </section>

        <nav class="sidebar neumorphism-panel">
            <h2>ğŸ—ºï¸ è·¯ç·šè¦åŠƒèˆ‡æ™¯é»</h2>
            
            <ul class="menu-list" id="category-menu">
                <li><a href="#" class="neumorphism-item active" data-action="filter-all">ğŸ‡¹ğŸ‡¼ æ‰€æœ‰æ™¯é»</a></li>
                <li><a href="#" class="neumorphism-item" data-action="filter-nature">ğŸï¸ è‡ªç„¶é¢¨å…‰</a></li>
                <li><a href="#" class="neumorphism-item" data-action="filter-history">ğŸ›ï¸ æ­·å²æ–‡åŒ–</a></li>
            </ul>

            <hr style="border-top: 1px solid #c0c0c0; margin: 15px 0;">

            <div class="route-overview">
                <h3>ğŸ“… AI è¡Œç¨‹æ¦‚è¦½</h3>
                <ul id="itinerary-days-menu" class="menu-list">
                    <li><a href="#" class="neumorphism-item disabled">é»æ“Šã€Œç”Ÿæˆå„ªåŒ–è·¯ç·šã€</a></li>
                </ul>
            </div>

            <div class="route-planning">
                <h3>AI è·¯ç·šç”Ÿæˆ</h3>
                
                <label for="start-location">èµ·å§‹åœ°ï¼š</label>
                <input type="text" id="start-location" placeholder="e.g., å°åŒ—è»Šç«™" class="neumorphism-input">

                <label for="interest-tags">æ—…éŠåå¥½ (Tag)ï¼š</label>
                <input type="text" id="interest-tags" placeholder="e.g., è‡ªç„¶,ç¾é£Ÿ" class="neumorphism-input">

                <label for="duration-days">å¤©æ•¸ï¼š</label>
                <select id="duration-days" class="neumorphism-select">
                    <option value="1">1å¤©</option>
                    <option value="2">2å¤©</option>
                    <option value="3" selected>3å¤©</option>
                    <option value="5">5å¤©</option>
                </select>
                
                <label for="must-visit">å¿…è¨ªæ™¯é» (Ctrl/Cmd+Clickå¡ç‰‡)</label>
                <input type="text" id="must-visit" placeholder="e.g., 101,æ—¥æœˆæ½­" class="neumorphism-input">

                <button id="generate-route-btn" class="neumorphism-button accent-button">ğŸ”¥ ç”Ÿæˆå„ªåŒ–è·¯ç·š</button>
            </div>
        </nav>

        <main class="main-content">
            <section id="route-result-section" class="neumorphism-panel" style="display:none;">
                <h2>ğŸ“‹ è·¯ç·šè¦åŠƒçµæœ</h2>
                <div id="route-result-content" class="route-message">
                    </div>
            </section>
            
            <section class="attraction-cards">
                <h2>ğŸŒŸ ç²¾é¸æ™¯é»å¡ç‰‡</h2>
                <p style="font-size: 0.9em; color: #555; margin-bottom: 20px;">
                    ğŸ’¡ **æç¤º:** æŒ‰ä½ **Ctrl** (æˆ– **Cmd**) éµé»æ“Šå¡ç‰‡ï¼Œå¯å°‡å…¶è¨­ç‚ºå¿…è¨ªç›®çš„åœ°ã€‚
                </p>
                <div id="cards-container" class="cards-container">
                    </div>
            </section>

            <section id="map-display" class="map-display neumorphism-panel">
                <h2>ğŸ“ åœ°åœ–å±•ç¤ºå€</h2>
                <div id="map-placeholder" class="map-placeholder">
                    [åœ°åœ–æ¨¡æ“¬ç•«é¢ï¼šé¡¯ç¤ºè·¯ç·šå’Œæ™¯é»æ¨™è¨˜]
                </div>
            </section>
        </main>
    </div>

    <script>
        /* ========================================= */
        /* JavaScript äº’å‹•é‚è¼¯ (å·²æ›´æ–°è·¯å¾‘) */
        /* ========================================= */

        // --- æ¨¡æ“¬è³‡æ–™èˆ‡å…¨åŸŸè®Šæ•¸ ---
        const taiwanAttractions = [
            { id: 'sunmoon', name: 'æ—¥æœˆæ½­', description: 'è‡ºç£æœ€å¤§çš„å¤©ç„¶æ¹–æ³Šï¼Œæ¹–å…‰å±±è‰²ï¼Œé¢¨æ™¯ç§€éº—ã€‚', coordinates: 'N 23.8966, E 120.9167', coord_val: { x: 10, y: 15 }, score: 95, tags: ['è‡ªç„¶', 'æ¹–æ™¯', 'ä¼‘é–’'], image: 'images/sunmoon_default.jpg' },
            { id: 'taipei101', name: 'å°åŒ—101', description: 'æ›¾ç‚ºä¸–ç•Œç¬¬ä¸€é«˜æ¨“ï¼Œæ˜¯å°åŒ—å¸‚é‡è¦çš„åœ°æ¨™ã€‚', coordinates: 'N 25.0330, E 121.5654', coord_val: { x: 5, y: 5 }, score: 98, tags: ['åŸå¸‚', 'åœ°æ¨™', 'è³¼ç‰©'], image: 'images/taipei101_default.jpg' },
            { id: 'taroko', name: 'å¤ªé­¯é–£åœ‹å®¶å…¬åœ’', description: 'ä»¥é›„å‰å£¯éº—çš„å³½è°·æ™¯è§€èåã€‚', coordinates: 'N 24.1667, E 121.5000', coord_val: { x: 30, y: 25 }, score: 92, tags: ['è‡ªç„¶', 'å³½è°·', 'å¥è¡Œ'], image: 'images/taroko_default.jpg' },
            { id: 'ali', name: 'é˜¿é‡Œå±±', description: 'äº”å¥‡ï¼ˆæ—¥å‡ºã€é›²æµ·ã€æ™šéœã€æ£®æ—ã€éµé“ï¼‰èåä¸­å¤–ã€‚', coordinates: 'N 23.5152, E 120.8123', coord_val: { x: 15, y: 35 }, score: 90, tags: ['è‡ªç„¶', 'æ—¥å‡º', 'æ£®æ—'], image: 'images/ali_default.jpg' },
            { id: 'tainan_old', name: 'å®‰å¹³å¤å ¡', description: 'è‡ºç£æœ€å¤è€çš„åŸå ¡ä¹‹ä¸€ï¼Œè¦‹è­‰äº†è‡ºç£æ­·å²çš„è®Šé·ã€‚', coordinates: 'N 23.0016, E 120.1656', coord_val: { x: 25, y: 10 }, score: 88, tags: ['æ­·å²', 'æ–‡åŒ–', 'å¤è¹Ÿ'], image: 'images/tainan_default.jpg' },
            { id: 'kaohsiung_harbor', name: 'é«˜é›„æ¸¯', description: 'è‡ºç£æœ€å¤§çš„æµ·æ¸¯ï¼Œå¤œæ™šçš„ç‡ˆå…‰æ™¯è‰²éå¸¸è¿·äººã€‚', coordinates: 'N 22.6167, E 120.2833', coord_val: { x: 20, y: 40 }, score: 85, tags: ['åŸå¸‚', 'æµ·æ¸¯', 'å¤œæ™¯'], image: 'images/kaohsiung_default.jpg' }
        ];
        let currentOptimizedRoute = null; 
        
        // --- æ ¸å¿ƒåŠŸèƒ½å‡½æ•¸ (éƒ¨åˆ†çœç•¥ä»¥ç¯€çœç¯‡å¹…ï¼Œåƒ…é¡¯ç¤ºèˆ‡å•é¡Œç›¸é—œçš„ä¿®æ”¹) ---

        function getDistance(p1, p2) {
            return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));
        }
        
        function updateMapDisplayMultiple(attractions) { /* ... (åŠŸèƒ½ä¸è®Š) ... */
            const mapPlaceholder = document.getElementById('map-placeholder');
            const color = attractions.length > 0 ? '#f0f4f8' : '#d8dee8';
            
            if (attractions && attractions.length > 0) {
                const attractionNames = attractions.map(a => a.name).join(' â†’ ');
                mapPlaceholder.innerHTML = `
                    <h3>ğŸ—ºï¸ ç•¶å‰è¡Œç¨‹åœ°åœ–è¦–åœ–</h3>
                    <p>åœ°åœ–æ¨¡æ“¬ï¼šé¡¯ç¤º ${attractions.length} å€‹æ™¯é»ä¸¦æ¨™è¨˜è·¯ç·š:</p>
                    <p style="font-weight:normal;">${attractionNames}</p>
                    <p style="color:var(--accent-color); font-weight:normal;">(å¯¦éš›æ‡‰ç”¨ä¸­æ­¤è™•æœƒé¡¯ç¤ºè¡Œç¨‹é€£ç·šåœ–)</p>
                `;
            } else {
                mapPlaceholder.innerHTML = '[åœ°åœ–æ¨¡æ“¬ç•«é¢ï¼šé¡¯ç¤ºè·¯ç·šå’Œæ™¯é»æ¨™è¨˜]';
            }
            mapPlaceholder.style.backgroundColor = color;
        }

        function filterCardsByDay(day) { /* ... (åŠŸèƒ½ä¸è®Š) ... */
            const allCards = document.querySelectorAll('.attraction-card');
            let visibleIds = [], attractionsToShow = [];

            if (day === 0 || day === 'all-category') { 
                allCards.forEach(card => card.style.display = 'flex');
                updateMapDisplayMultiple([]);
                return;
            } else if (day === 'all' && currentOptimizedRoute) { 
                attractionsToShow = currentOptimizedRoute.flat();
            } else if (currentOptimizedRoute && day > 0) { 
                const dayIndex = day - 1;
                if (currentOptimizedRoute[dayIndex]) attractionsToShow = currentOptimizedRoute[dayIndex];
            }
            
            visibleIds = attractionsToShow.map(a => a.id);
            allCards.forEach(card => card.style.display = visibleIds.includes(card.getAttribute('data-id')) ? 'flex' : 'none');
            updateMapDisplayMultiple(attractionsToShow);
        }
        
        function updateSidebarOverview(dailyStops) { /* ... (åŠŸèƒ½ä¸è®Š) ... */
            const menu = document.getElementById('itinerary-days-menu');
            menu.innerHTML = '';
            
            if (!dailyStops || dailyStops.length === 0) {
                menu.innerHTML = '<li><a href="#" class="neumorphism-item disabled">é»æ“Šã€Œç”Ÿæˆå„ªåŒ–è·¯ç·šã€</a></li>';
                filterCardsByDay(0); 
                return;
            }

            menu.innerHTML += `
                <li>
                    <a href="#" class="neumorphism-item route-day-btn" data-action="filter-day" data-day="all">
                        ğŸ‘ï¸ é¡¯ç¤ºæ‰€æœ‰è¡Œç¨‹æ™¯é»
                    </a>
                </li>
            `;

            dailyStops.forEach((dayStops, index) => {
                const day = index + 1;
                menu.innerHTML += `
                    <li>
                        <a href="#" class="neumorphism-item route-day-btn" data-action="filter-day" data-day="${day}">
                            ğŸ—“ï¸ ç¬¬ ${day} å¤© (${dayStops.length} ç«™)
                        </a>
                    </li>
                `;
            });
            
            const firstDayBtn = document.querySelector('.route-day-btn[data-day="1"]') || document.querySelector('.route-day-btn[data-day="all"]');
            if (firstDayBtn) {
                 firstDayBtn.classList.add('active');
                 filterCardsByDay(firstDayBtn.getAttribute('data-day'));
            }
        }
        
        function generateOptimizedRoute(startLocation, interestTags, durationDays, mustVisitNames) { /* ... (åŠŸèƒ½ä¸è®Š) ... */
            const totalDays = parseInt(durationDays, 10);
            const requiredTags = interestTags.split(',').map(tag => tag.trim().toLowerCase()).filter(t => t);
            const mustVisit = mustVisitNames.split(',').map(name => name.trim()).filter(n => n);
            
            let filteredAttractions = taiwanAttractions.filter(attraction => {
                const tagMatch = requiredTags.length === 0 || attraction.tags.some(tag => requiredTags.includes(tag.toLowerCase()));
                return tagMatch;
            });

            let selectedRoute = taiwanAttractions.filter(a => mustVisit.includes(a.name));
            let pool = filteredAttractions.filter(a => !mustVisit.includes(a.name));
            
            const maxAttractions = totalDays * 3;
            pool.sort((a, b) => b.score - a.score);
            for (let i = 0; selectedRoute.length < maxAttractions && i < pool.length; i++) {
                selectedRoute.push(pool[i]);
            }

            if (selectedRoute.length === 0) return "æ‰¾ä¸åˆ°ç¬¦åˆæ‚¨æ¢ä»¶çš„æ™¯é»ã€‚";

            let optimizedOrder = [];
            let currentPoint = { name: startLocation, coord_val: { x: 20, y: 10 } }; 
            let remaining = [...selectedRoute];

            while (remaining.length > 0) {
                let nearestIndex = -1, minDistance = Infinity;
                for (let i = 0; i < remaining.length; i++) {
                    const dist = getDistance(currentPoint.coord_val, remaining[i].coord_val);
                    if (dist < minDistance) {
                        minDistance = dist;
                        nearestIndex = i;
                    }
                }
                const nextAttraction = remaining.splice(nearestIndex, 1)[0];
                optimizedOrder.push(nextAttraction);
                currentPoint = nextAttraction;
            }

            const attractionsPerDay = Math.ceil(optimizedOrder.length / totalDays);
            let itinerary = [];
            let dailyStops = [];
            let totalDistance = 0;

            for (let day = 0; day < totalDays; day++) {
                const startIndex = day * attractionsPerDay;
                const stops = optimizedOrder.slice(startIndex, startIndex + attractionsPerDay);
                
                if (stops.length > 0) {
                    dailyStops.push(stops);
                    let dailyRoute = [`å¾ ${day === 0 ? startLocation : 'å‰ä¸€å¤©ä½å®¿åœ°é»'} å‡ºç™¼`];
                    let lastCoord = day === 0 ? { x: 20, y: 10 } : stops[0].coord_val;
                    
                    stops.forEach((stop) => {
                        const travelDist = getDistance(lastCoord, stop.coord_val);
                        totalDistance += travelDist;
                        dailyRoute.push(`â¡ï¸ è¨ªå• ${stop.name} (åœç•™ç´„ 3å°æ™‚ï¼Œè·é›¢æ¨¡æ“¬: ${travelDist.toFixed(1)} km)`);
                        lastCoord = stop.coord_val;
                    });

                    dailyRoute.push(`ğŸ›Œ æ™šä¸Šåœ¨ ${stops[stops.length - 1].name} é™„è¿‘ä½å®¿ã€‚`);
                    itinerary.push(`**ç¬¬ ${day + 1} å¤©:**\n* ` + dailyRoute.join('\n* '));
                }
            }

            return { itinerary: itinerary.join('\n\n'), totalDistance: totalDistance.toFixed(1), dailyStops: dailyStops };
        }
        
        // --- äº‹ä»¶è™•ç†å™¨ (è™•ç†è·¯ç·šç”Ÿæˆï¼Œå·²æ›´æ–°ç›®æ¨™ ID) ---

        function handleRouteGeneration() {
            // ç²å–æ–°çš„ä¸­å¤®é¡¯ç¤ºå€å¡Š
            const resultSection = document.getElementById('route-result-section');
            const resultContent = document.getElementById('route-result-content');
            
            const start = document.getElementById('start-location').value || 'å°ç£ä»»ä¸€åœ°é»';
            const tags = document.getElementById('interest-tags').value;
            const days = document.getElementById('duration-days').value;
            const must = document.getElementById('must-visit').value;
            
            resultSection.style.display = 'block'; // é¡¯ç¤ºè·¯ç·šçµæœå€å¡Š

            if (!localStorage.getItem('geminiApiKey')) {
                resultContent.innerHTML = '<p style="color:var(--error-color);">è«‹å…ˆé©—è­‰æ‚¨çš„ API Key æ‰èƒ½ä½¿ç”¨ AI è¦åŠƒåŠŸèƒ½ï¼</p>';
                return;
            }

            resultContent.innerHTML = '<p>ğŸš€ AI æ­£åœ¨è™•ç†è¤‡é›œçš„æ—…è¡Œæ¨éŠ·å“¡å•é¡Œ (TSP)...</p>';
            resultContent.style.color = '#333';
            
            setTimeout(() => {
                const routeData = generateOptimizedRoute(start, tags, days, must);

                if (typeof routeData === 'string') {
                    resultContent.innerHTML = `<p style="color:var(--error-color);">${routeData}</p>`;
                    currentOptimizedRoute = null;
                    updateSidebarOverview(null);
                } else {
                    resultContent.innerHTML = `
                        <h4>âœ… æœ€ä½³åŒ–è¡Œç¨‹ (å…± ${routeData.totalDistance} km æ¨¡æ“¬è·é›¢)</h4>
                        <pre>${routeData.itinerary}</pre>
                        <p style="color:var(--success-color); font-weight:bold;">âœ¨ æˆåŠŸç”Ÿæˆï¼è«‹é»æ“Šå·¦å´ã€ŒAI è¡Œç¨‹æ¦‚è¦½ã€æŒ‰éˆ•æŸ¥çœ‹æ¯æ—¥ç´°ç¯€ã€‚</p>
                    `;
                    
                    currentOptimizedRoute = routeData.dailyStops;
                    updateSidebarOverview(routeData.dailyStops);
                }
            }, 1500);
        }

        // --- åˆå§‹åŒ– ---
        document.addEventListener('DOMContentLoaded', () => {
            // ... (å…¶ä»–å‡½æ•¸ä¿æŒä¸è®Š)
            function loadAttractionCards() { /* ... */ }
            function handleApiVerification() { /* ... */ }
            function toggleDetails(cardId) { /* ... */ }
            function simulateAIGeneration(attractionName, cardId) { /* ... */ }
            function updateMapDisplaySingle(attraction) { /* ... */ }
            function handleGlobalClick(event) { /* ... */ }
            function handleCardClickForMustVisit(event) { /* ... */ }
            
            // ç¶å®š API é©—è­‰æŒ‰éˆ•
            document.getElementById('verify-api-btn').addEventListener('click', handleApiVerification);
            
            // ç¶å®šè·¯ç·šç”ŸæˆæŒ‰éˆ• (èª¿ç”¨æ›´æ–°å¾Œçš„å‡½æ•¸)
            document.getElementById('generate-route-btn').addEventListener('click', handleRouteGeneration);

            // å…¨åŸŸé»æ“Šäº‹ä»¶å§”æ´¾ (è™•ç† sidebar å’Œå¡ç‰‡æŒ‰éˆ•)
            document.addEventListener('click', handleGlobalClick);

            // æ™¯é»å¡ç‰‡é»æ“Šè¨­å®šç›®çš„åœ°åŠŸèƒ½ (Ctrl/Cmd + Click)
            document.getElementById('cards-container').addEventListener('click', handleCardClickForMustVisit);

            // è¼‰å…¥æ™¯é»
            loadAttractionCards();
        });
        
        // (çœç•¥äº†éƒ¨åˆ†æœªä¿®æ”¹çš„è¼”åŠ©å‡½æ•¸å®šç¾©ï¼Œä½†åœ¨å¯¦éš›ä»£ç¢¼ä¸­æ‡‰ä¿ç•™)

        // é‡æ–°å®šç¾©çš„å¹¾å€‹è¼”åŠ©å‡½æ•¸ (ç‚ºç¢ºä¿é‚è¼¯å®Œæ•´æ€§)
        function createAttractionCard(attraction) {
            const imgSrc = attraction.image.includes('default') ? `[AI ç”Ÿæˆåœ–ç‰‡é è¦½å€]` : `<img src="${attraction.image}" alt="${attraction.name}">`;
            return `<div class="attraction-card neumorphism-card" data-id="${attraction.id}"><div class="card-image-placeholder" id="img-placeholder-${attraction.id}">${imgSrc}</div><div class="card-content"><h3 class="card-title">${attraction.name}</h3><p class="description card-description-${attraction.id}">${attraction.description.substring(0, 20)}...</p><div class="card-details card-details-${attraction.id}" style="display:none; margin-bottom: 10px;"><p><strong>åº§æ¨™:</strong> <span class="card-coord">${attraction.coordinates}</span></p></div><button class="neumorphism-button small-button toggle-details-btn" data-action="toggle-details" data-id="${attraction.id}">æŸ¥çœ‹è©³æƒ…</button><button class="neumorphism-button small-button generate-image-btn" data-action="generate-image" data-name="${attraction.name}">æ¨¡æ“¬ AI ç”Ÿæˆæ–°åœ–</button></div></div>`;
        }
        function loadAttractionCards() { document.getElementById('cards-container').innerHTML = taiwanAttractions.map(createAttractionCard).join(''); filterCardsByDay(0); }
        function handleApiVerification() { const key = document.getElementById('gemini-key').value.trim(); const statusText = document.getElementById('api-status'); if (key.length > 10 && key.startsWith('AIZA')) { statusText.innerHTML = 'âœ… API Key é©—è­‰æˆåŠŸï¼'; statusText.style.color = 'var(--primary-color)'; localStorage.setItem('geminiApiKey', key); } else { statusText.innerHTML = 'âŒ è«‹è¼¸å…¥æœ‰æ•ˆçš„ Gemini API Keyã€‚ (æ¨¡æ“¬æ ¼å¼: AIZA...)'; statusText.style.color = 'var(--error-color)'; localStorage.removeItem('geminiApiKey'); } }
        function updateMapDisplaySingle(attraction) { /* ä¿æŒä¸è®Š */ }
        function toggleDetails(cardId) { /* ä¿æŒä¸è®Š */ }
        function simulateAIGeneration(attractionName, cardId) { /* ä¿æŒä¸è®Š */ }
        function handleGlobalClick(event) { /* ä¿æŒä¸è®Š */ }
        function handleCardClickForMustVisit(event) { /* ä¿æŒä¸è®Š */ }

    </script>
</body>
</html>
